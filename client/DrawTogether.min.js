function Chat(c,a){this.messagesDom=c.appendChild(document.createElement("div"));this.messagesDom.classList.add("messagecontainer");this.inputContainerDom=c.appendChild(document.createElement("div"));this.inputContainerDom.classList.add("inputcontainer");this.input=this.inputContainerDom.appendChild(document.createElement("input"));this.input.placeholder="Chatmessage here...";this.input.className="drawtogheter-chat-input";this.input.addEventListener("keypress",function(c){13==c.keyCode&&this.sendChat()}.bind(this));
this.input.maxLength=255;button=this.inputContainerDom.appendChild(document.createElement("div"));button.classList.add("button-small");button.appendChild(document.createTextNode("Send"));button.addEventListener("click",this.sendChat.bind(this));this.onMessage=a||function(){}}
Chat.prototype.string2Color=function(c){for(var a=2348,b=0.9,e=0.4,d=Math.max(c.length-1,2);0<=d;d--)for(var f=c.length-1;0<=f;f--)a=(a<<5)-a+~c.charCodeAt(f);0>a&&(a=-a,e=0.35);360<a&&(c=parseInt(a/360),a-=360*c,0===c%3?b=1:0===c%2&&(b=0.95));return"hsl("+a+", "+100*b+"%, "+70*e+"%)"};
Chat.prototype.addMessage=function(c,a){max_scroll=Math.floor(this.messagesDom.scrollHeight-this.messagesDom.getBoundingClientRect().height);old_scroll=Math.ceil(this.messagesDom.scrollTop);messageDom=this.messagesDom.appendChild(document.createElement("div"));messageDom.classList.add("chat-message");var b=new Date,b=("0"+b.getHours()).slice(-2)+":"+("0"+b.getMinutes()).slice(-2)+":"+("0"+b.getSeconds()).slice(-2);"undefined"==typeof a?messageDom.appendChild(document.createTextNode("["+b+"] "+c)):
(messageDom.appendChild(document.createTextNode("["+b+"] ")),b=messageDom.appendChild(document.createElement("span")),b.innerText=c+": ",b.style.color=this.string2Color(c),messageDom.appendChild(document.createTextNode(a)));max_scroll<=old_scroll&&(this.messagesDom.scrollTop=this.messagesDom.scrollHeight-this.messagesDom.getBoundingClientRect().height)};Chat.prototype.sendChat=function(){this.onMessage(this.input.value);this.input.value=""};function DrawTogether(c,a){this.KICKBAN_MIN_REP=50;this.container=c;this.settings=this.utils.merge(this.utils.copy(a),this.defaultSettings);this.playerList=[];this.ink=5E3;this.lastInkWarning=Date.now();this.initDom();this.gui=new Gui(c);this.network=new Network("http://localhost:3552");this.bindSocketHandlers();"ask"==this.settings.mode?this.openModeSelector():"join"==this.settings.mode?this.changeRoom(this.settings.room):"private"==this.settings.mode&&(this.settings.room="private_"+Math.random().toString(36).substr(2,
5),this.changeRoom(this.settings.room));requestAnimationFrame(this.drawLoop.bind(this));this.needsClear=!1;document.addEventListener("keypress",function(c){27==c.keyCode&&(this.closeAccountWindow(),this.closeShareWindow(),this.closeRoomWindow())}.bind(this))}DrawTogether.prototype.defaultSettings={mode:"ask",room:"main"};DrawTogether.prototype.drawingTypes=["line","brush","block"];DrawTogether.prototype.drawingTypesByName={line:0,brush:1,block:2};
DrawTogether.prototype.drawLoop=function(){this.needsClear&&(this.userCtx.clearRect(0,0,this.userCtx.canvas.width,this.userCtx.canvas.height),this.needsClear=!1);for(var c=0;c<this.playerList.length;c++)this.playerList[c].lastPosition&&1500>Date.now()-this.playerList[c].lastPosition.time&&(this.drawPlayerInteraction(this.playerList[c].name,this.playerList[c].lastPosition.pos),this.needsClear=!0);requestAnimationFrame(this.drawLoop.bind(this))};
DrawTogether.prototype.drawPlayerInteraction=function(c,a){this.userCtx.font="12px monospace";this.userCtx.strokeStyle="black";this.userCtx.lineWidth=3;this.userCtx.strokeText(c,a[0]*this.paint.public.zoom-this.userCtx.canvas.leftTopX,a[1]*this.paint.public.zoom-40-this.userCtx.canvas.leftTopY);this.userCtx.fillStyle="white";this.userCtx.fillText(c,a[0]*this.paint.public.zoom-this.userCtx.canvas.leftTopX,a[1]*this.paint.public.zoom-40-this.userCtx.canvas.leftTopY)};
DrawTogether.prototype.bindSocketHandlers=function(){var c=this;this.network.on("connect",function(){localStorage.getItem("drawtogether-name")&&c.changeName(localStorage.getItem("drawtogether-name"));c.current_room&&(delete c.current_room,c.changeRoom(c.current_room))});this.network.on("initname",function(a){localStorage.getItem("drawtogether-name")||c.setName(a)});this.network.on("drawing",function(a){var b=c.decodeDrawing(a.drawing);c.paint.drawDrawing("public",b);c.setPlayerPosition(a.socketid,
[b.x,b.y],Date.now())});this.network.on("playernamechange",function(a){for(var b=0;b<c.playerList.length;b++)c.playerList[b].id==a.id&&(c.playerList[b].name=a.newname);c.updatePlayerList()});this.network.on("playerlist",function(a){c.playerList=a;c.updatePlayerList()});this.network.on("leave",function(a){for(var b=0;b<c.playerList.length;b++)c.playerList[b].id==a.id&&(c.playerList.splice(b,1),b--);c.updatePlayerList()});this.network.on("join",function(a){for(var b=0;b<c.playerList.length;b++)if(c.playerList[b].id==
a.id)return;c.playerList.push(a);c.updatePlayerList()});this.network.on("reputation",function(a){for(var b=0;b<c.playerList.length;b++)c.playerList[b].id==a.id&&(c.playerList[b].reputation=a.reputation);c.updatePlayerList()});this.network.on("generalmessage",function(a){c.displayMessage(a)});this.network.on("gamestatus",function(a){c.chat.addMessage("GAME",c.usernameFromSocketid(a.currentPlayer)+" is now drawing. You have "+Math.round(a.timeLeft/1E3)+" seconds left.");c.chat.addMessage("GAME","The word contains some of the following letters: "+
a.letters.join(", "));c.displayMessage("The word contains some of the following letters: "+a.letters.join(", "));for(var b=0;b<a.players.length;b++)for(var e=0;e<c.playerList.length;e++)c.playerList[e].id==a.players[b].id&&(c.playerList[e].gamescore=a.players[b].score);c.updatePlayerList()});this.network.on("gameword",function(a){c.chat.addMessage("GAME","It is your turn now! Please draw "+a);c.displayMessage("It is your turn now! Please draw '"+a+"' you have 60 seconds!")});this.network.on("chatmessage",
function(a){a=a||{};c.chat.addMessage(a.user,a.message)});this.network.on("emote",function(a){a=a||{};c.chat.addMessage(a.user+" "+a.message)})};DrawTogether.prototype.sendMessage=function(c){this.network.socket.emit("chatmessage",c)};
DrawTogether.prototype.displayMessage=function(c,a){this.messageDom.style.display="block";this.messageDom.innerText=c;this.messageDom.textContent=c;clearTimeout(this.removeMessageTimeout);this.removeMessageTimeout=setTimeout(function(){this.messageDom.style.display=""}.bind(this),a||Math.max(1E3*Math.ceil(c.length/10),3E3))};
DrawTogether.prototype.changeRoom=function(c,a){c===this.current_room?this.chat.addMessage("CLIENT","You are already in room '"+c+"'"):(a=a||"",this.network.loadRoom(c+a,function(b,e,d){"Too many users"==b?this.changeRoom(c,(a||0)+1):b?this.chat.addMessage("SERVER","Failed to load room '"+c+"'. Server error: "+b):(this.paint.clear(),this.setRoom(c),this.paint.drawDrawings("public",this.decodeDrawings(e)),this.chat.addMessage("CLIENT","Ready to draw."),this.chat.addMessage("CLIENT","Invite: http://www.anondraw.com/#"+
c+a),this.playerList=d,this.updatePlayerList(),this.removeLoading())}.bind(this)),this.setLoading(c),this.chat.addMessage("CLIENT","Changing room to '"+c+a+"'"))};DrawTogether.prototype.setLoading=function(c){this.loading||(this.loading=this.paintContainer.appendChild(document.createElement("div")),this.loading.innerText="Loading room '"+c+"' ...",this.loading.textContent="Loading room '"+c+"' ...",this.loading.className="drawtogether-loading")};
DrawTogether.prototype.removeLoading=function(){this.loading&&(this.loading.parentNode.removeChild(this.loading),delete this.loading)};DrawTogether.prototype.changeName=function(c){c||(c=this.controls.byName.name.input.value,this.controls.byName.name.input.focus());this.network.socket.emit("changename",c,function(c){this.chat.addMessage("SERVER","Changed name to "+c);localStorage.setItem("drawtogether-name",c)}.bind(this))};
DrawTogether.prototype.updatePlayerList=function(){for(;this.playerListDom.firstChild;)this.playerListDom.removeChild(this.playerListDom.firstChild);var c=this.playerListDom.appendChild(document.createElement("span"));c.innerText="PlayerList ("+this.playerList.length+")";c.textContent="PlayerList ("+this.playerList.length+")";c.className="drawtogether-pl-title";for(c=0;c<this.playerList.length;c++)this.playerListDom.appendChild(this.createPlayerDom(this.playerList[c]))};
DrawTogether.prototype.setPlayerPosition=function(c,a,b){for(var e=0;e<this.playerList.length;e++)this.playerList[e].id==c&&(this.playerList[e].lastPosition=this.playerList[e].lastPosition||{},this.playerList[e].lastPosition.pos=a,this.playerList[e].lastPosition.time=b)};DrawTogether.prototype.sendDrawing=function(c,a){this.network.socket&&this.network.socket.emit("drawing",this.encodeDrawing(c),a)};
DrawTogether.prototype.encodeDrawing=function(c){var a=[this.drawingTypesByName[c.type],c.x,c.y,c.size,c.color];c.x1&&a.push(c.x1);c.y1&&a.push(c.y1);return a};DrawTogether.prototype.decodeDrawing=function(c){6==c[4].length&&(c[4]="#"+c[4]);var a={type:this.drawingTypes[c[0]],x:c[1],y:c[2],size:c[3],color:c[4]};c[5]&&(a.x1=c[5]);c[6]&&(a.y1=c[6]);return a};DrawTogether.prototype.decodeDrawings=function(c){for(var a=0;a<c.length;a++)c[a]=this.decodeDrawing(c[a]);return c};
DrawTogether.prototype.setName=function(c){this.controls.byName.name.input.value=c;this.chat.addMessage("SERVER","Name set to '"+c+"'");localStorage.setItem("drawtogether-name",c)};DrawTogether.prototype.setRoom=function(c){this.current_room=c;this.roomInput.value=c;location.hash=c};
DrawTogether.prototype.openShareWindow=function(){this.shareWindow.style.display="block";this.preview.width=0.9*this.shareWindow.offsetWidth;this.preview.height=this.preview.width*(this.paint.public.canvas.height/this.paint.public.canvas.width);this.preview.getContext("2d").drawImage(this.paint.public.canvas,0,0,this.preview.width,this.preview.height)};
DrawTogether.prototype.openRoomWindow=function(){this.roomWindow.style.display="block";this.network.getRooms(function(c){for(;this.publicRoomsContainer.firstChild;)this.publicRoomsContainer.removeChild(this.publicRoomsContainer.firstChild);for(var a in c){var b=this.publicRoomsContainer.appendChild(document.createElement("div"));b.className="drawtogether-button drawtogether-room-button";b.appendChild(document.createTextNode(a+" ("+c[a]+" users)"));b.addEventListener("click",this.changeRoom.bind(this,
a))}}.bind(this))};DrawTogether.prototype.openAccountWindow=function(){this.accWindow.style.display="block"};DrawTogether.prototype.openModeSelector=function(){this.selectWindow.style.display="block"};DrawTogether.prototype.closeShareWindow=function(){this.shareWindow.style.display=""};DrawTogether.prototype.closeAccountWindow=function(){this.accWindow.style.display=""};DrawTogether.prototype.closeRoomWindow=function(){this.roomWindow.style.display=""};
DrawTogether.prototype.initDom=function(){this.createChat();this.createRoomInformation();this.createDrawZone();this.createControls();this.createMessage();this.createShareWindow();this.createAccountWindow();this.createRoomWindow();this.createModeSelector()};DrawTogether.prototype.usernameFromSocketid=function(c){for(var a=0;a<this.playerList.length;a++)if(this.playerList[a].id==c)return this.playerList[a].name;return"[Not found]"};
DrawTogether.prototype.createPlayerDom=function(c){var a=document.createElement("div");a.className="drawtogether-player";var b=document.createElement("span");b.className="drawtogether-player-button drawtogether-upvote-button";b.innerText="\u25b2";b.textContent="\u25b2";b.addEventListener("click",function(c,a){}.bind(this,c.id));if(this.reputation>=this.KICKBAN_MIN_REP){var e=document.createElement("span");e.className="drawtogether-player-button drawtogether-kickban-button";e.innerText="B";e.textContent=
"B";e.addEventListener("click",this.kickban.bind(this,c.id));a.appendChild(e)}e=document.createElement("span");e.className="drawtogether-player-name";var d="",f="";"undefined"!==typeof c.reputation&&(d=" ("+c.reputation+" R)");"undefined"!==typeof c.gamescore&&(f=" ["+c.gamescore+" Points]");e.innerText=c.name+d+f;e.textContent=c.name+d+f;a.appendChild(b);a.appendChild(e);return a};
DrawTogether.prototype.kickban=function(c){this.gui.prompt("How long do you want to kickban this person for? (minutes)",["freepick","Cancel"],function(a){"Cancel"!=a&&this.gui.prompt("Should we ban the account, the ip or both?",["account","ip","both","Cancel"],function(b){"Cancel"!=b&&this.gui.prompt("Are you sure you want to ban "+this.usernameFromSocketid(c)+" (bantype: "+b+") for "+a+" minutes.",["Yes","No"],function(e){"Yes"==e&&this.network.socket.emit("kickban",[c,a,b],function(c){this.chat.addMessage("SERVER",
c.error||c.success)}.bind(this))}.bind(this))}.bind(this))}.bind(this))};DrawTogether.prototype.createChat=function(){var c=this.container.appendChild(document.createElement("div"));c.className="drawtogether-chat-container";this.chat=new Chat(c,this.sendMessage.bind(this));this.chatContainer=c};
DrawTogether.prototype.createDrawZone=function(){var c=this.container.appendChild(document.createElement("div"));c.className="drawtogether-paint-container";this.paintContainer=c;this.paint=new Paint(c);this.userCtx=this.paint.newCanvasOnTop("userinteraction").getContext("2d");this.paint.addEventListener("userdrawing",function(c){this.sendDrawing(c.drawing,function(){c.removeDrawing()})}.bind(this))};
DrawTogether.prototype.createMessage=function(){this.messageDom=this.container.appendChild(document.createElement("div"));this.messageDom.className="drawtogether-general-message"};
DrawTogether.prototype.createRoomInformation=function(){var c=this.container.appendChild(document.createElement("div"));c.className="drawtogether-info-container";this.infoContainer=c;var a=c.appendChild(document.createElement("div"));a.className="drawtogether-ink-container";this.inkDom=a.appendChild(document.createElement("div"));this.inkDom.className="drawtogether-ink";this.playerListDom=c.appendChild(document.createElement("div"));this.playerListDom.className="drawtogether-info-playerlist"};
DrawTogether.prototype.createGameInformation=function(){var c=this.container.appendChild(document.createElement("div"));c.className="drawtogether-gameinfo-container";this.gameInfoContainer=c};
DrawTogether.prototype.createAccountWindow=function(){var c=this.container.appendChild(document.createElement("div"));c.className="drawtogether-window drawtogether-accountwindow";this.accWindow=c;c=c.appendChild(document.createElement("div"));c.className="drawtogether-account-formcontainer";this.loginMessage=c.appendChild(document.createElement("div"));var a=c.appendChild(document.createElement("input"));a.type="email";a.placeholder="email@example.com";this.emailInput=a;a=c.appendChild(document.createElement("input"));
a.type="password";a.placeholder="*********";this.passInput=a;this.emailInput.addEventListener("keydown",function(c){13==c.keyCode&&this.formLogin()}.bind(this));this.passInput.addEventListener("keydown",function(c){13==c.keyCode&&this.formLogin()}.bind(this));a=c.appendChild(document.createElement("div"));a.innerText="Login/Register";a.textContent="Login/Register";a.className="drawtogether-button drawtogether-login-button";a.addEventListener("click",this.formLogin.bind(this));a=c.appendChild(document.createElement("div"));
a.innerText="Logout";a.textContent="Logout";a.className="drawtogether-button drawtogether-logout-button";a.addEventListener("click",function(){localStorage.removeItem("drawtogether/email");localStorage.removeItem("drawtogether/pass");this.closeAccountWindow()}.bind(this));c=c.appendChild(document.createElement("div"));c.innerText="Close room window";c.textContent="Close room window";c.className="drawtogether-button drawtogether-close-button";c.addEventListener("click",this.closeAccountWindow.bind(this))};
DrawTogether.prototype.createRoomWindow=function(){this.roomWindow=this.container.appendChild(document.createElement("div"));this.roomWindow.className="drawtogether-window drawtogether-roomwindow";var c=this.roomWindow.appendChild(document.createElement("div"));c.className="drawtogether-roomwindow-content";var a=c.appendChild(document.createElement("div"));a.innerText="Public Rooms:";a.textContent="Public Rooms:";a.className="drawtogether-room-text";this.publicRoomsContainer=c.appendChild(document.createElement("div"));
this.publicRoomsContainer.className="drawtogether-publicroomscontainer";a=c.appendChild(document.createElement("div"));a.innerText="Manual Room:";a.textContent="Manual Room:";a.className="drawtogether-room-text";this.roomInput=c.appendChild(document.createElement("input"));this.roomInput.type="text";this.roomInput.placeholder="Room";a=c.appendChild(document.createElement("div"));a.innerText="Change room";a.textContent="Change room";a.className="drawtogether-button";a.addEventListener("click",function(c){this.changeRoom(this.roomInput.value);
this.closeRoomWindow()}.bind(this));c=c.appendChild(document.createElement("div"));c.innerText="Close room window";c.textContent="Close room window";c.className="drawtogether-button drawtogether-close-button";c.addEventListener("click",this.closeRoomWindow.bind(this))};
DrawTogether.prototype.createControls=function(){var c=this.container.appendChild(document.createElement("div"));c.className="drawtogether-control-container";this.controls=new Controls(c,this.createControlArray());c.appendChild(document.createElement("div")).className="addthis_sharing_toolbox";this.controls.byName["share-button"].input.classList.add("drawtogether-flashy");this.controls.byName["toggle-chat"].input.classList.add("drawtogether-display-on-small");this.controls.byName["toggle-info"].input.classList.add("drawtogether-display-on-small")};
DrawTogether.prototype.formLogin=function(){var c=this.emailInput.value,a=CryptoJS.SHA256(this.passInput.value).toString(CryptoJS.enc.Base64);this.accountError(void 0);this.socket.emit("login",{email:c,password:a},function(b){b.error&&this.accountError(b.error);b.success&&(this.accountSuccess(b.success),localStorage.setItem("drawtogether/email",c),localStorage.setItem("drawtogether/pass",a),this.reputation=b.reputation,this.updatePlayerList())}.bind(this))};
DrawTogether.prototype.accountError=function(c){for(;this.loginMessage.firstChild;)this.loginMessage.removeChild(this.loginMessage.firstChild);if(c){var a=this.loginMessage.appendChild(document.createElement("div"));a.className="drawtogether-error drawtogether-login-error";a.innerText=c;a.textContent=c}};
DrawTogether.prototype.accountSuccess=function(c){for(;this.loginMessage.firstChild;)this.loginMessage.removeChild(this.loginMessage.firstChild);if(c){var a=this.loginMessage.appendChild(document.createElement("div"));a.className="drawtogether-success drawtogether-login-success";a.innerText=c;a.textContent=c}};
DrawTogether.prototype.uploadImage=function(){for(;this.imgurUrl.firstChild;)this.imgurUrl.removeChild(this.imgurUrl.firstChild);this.network.socket.emit("uploadimage",this.paint.public.canvas.toDataURL().split(",")[1],function(c){c.error?this.showShareError(c.error):this.showImgurUrl(c.url)}.bind(this))};
DrawTogether.prototype.showShareError=function(c){for(;this.shareError.firstChild;)this.shareError.removeChild(this.shareError.firstChild);var a=this.shareError.appendChild(document.createElement("div"));a.innerText=c;a.textContent=c;a.className="drawtogether-error drawtogether-share-error"};
DrawTogether.prototype.showImgurUrl=function(c){for(;this.imgurUrl.firstChild;)this.imgurUrl.removeChild(this.imgurUrl.firstChild);var a=this.imgurUrl.appendChild(document.createElement("div"));a.innerHTML='Uploaded on imgur: <a href="'+c+'">'+c+"</a>";a.className="drawtogether-share-url";this.shareToRedditButton.target="_blank";this.shareToRedditButton.href="http://www.reddit.com/r/anondraw/submit?title=[DRAWING]%20Description&url="+encodeURIComponent(c)};
DrawTogether.prototype.toggleChat=function(){this.chatContainer.classList.contains("drawtogether-unhide-on-mobile")?this.chatContainer.classList.remove("drawtogether-unhide-on-mobile"):this.chatContainer.classList.add("drawtogether-unhide-on-mobile")};DrawTogether.prototype.toggleInfo=function(){this.infoContainer.classList.contains("drawtogether-unhide-on-mobile")?this.infoContainer.classList.remove("drawtogether-unhide-on-mobile"):this.infoContainer.classList.add("drawtogether-unhide-on-mobile")};
DrawTogether.prototype.createShareWindow=function(){shareWindow=this.container.appendChild(document.createElement("div"));shareWindow.className="drawtogether-sharewindow";this.shareWindow=shareWindow;this.shareError=shareWindow.appendChild(document.createElement("div"));this.imgurUrl=shareWindow.appendChild(document.createElement("div"));var c=shareWindow.appendChild(document.createElement("canvas"));c.className="drawtogether-preview-canvas";this.preview=c;c=shareWindow.appendChild(document.createElement("div"));
c.className="drawtogether-button drawtogether-upload-button";c.innerText="Upload image to imgur";c.textContent="Upload image to imgur";c.addEventListener("click",this.uploadImage.bind(this));c=shareWindow.appendChild(document.createElement("a"));c.className="drawtogether-button drawtogether-share-button";c.innerText="Share image to reddit";c.textContent="Share image to reddit";c.href="#";this.shareToRedditButton=c;c.addEventListener("click",function(c){-1===c.href.indexOf("reddit")&&this.showShareError("First upload the image to imgur before uploading it to reddit!")}.bind(this,
c));c=shareWindow.appendChild(document.createElement("div"));c.innerText="Close share window";c.textContent="Close share window";c.className="drawtogether-button drawtogether-close-button";c.addEventListener("click",this.closeShareWindow.bind(this))};
DrawTogether.prototype.createModeSelector=function(){var c=this.container.appendChild(document.createElement("div"));c.className="drawtogether-selectwindow";this.selectWindow=c;var a=c.appendChild(document.createElement("h1"));a.innerText="Draw online with friends and strangers.";a.textContent="Draw online with friends and strangers.";a.className="drawtogether-welcome-text";a=c.appendChild(document.createElement("div"));a.className="drawtogether-modeselect-button";a.innerHTML='<img src="images/multi.png"/><br/>Draw with strangers';
a.addEventListener("click",function(){this.changeRoom("main");this.selectWindow.style.display=""}.bind(this));a=c.appendChild(document.createElement("div"));a.className="drawtogether-modeselect-button";a.innerHTML='<img src="images/invite.png"/><br/>Alone or with friends';a.addEventListener("click",function(){this.settings.room="private_"+Math.random().toString(36).substr(2,5);this.changeRoom(this.settings.room);this.selectWindow.style.display=""}.bind(this));this.redditDrawings=c.appendChild(document.createElement("div"));
this.redditDrawings.className="drawtogether-redditdrawings";this.populateRedditDrawings();c.appendChild(this.createFAQDom())};
DrawTogether.prototype.populateRedditDrawings=function(){var c=new XMLHttpRequest;c.addEventListener("readystatechange",function(a){if(4==c.readyState&&200==c.status){a=JSON.parse(c.responseText).data.children;var b=this.redditDrawings.appendChild(document.createElement("a"));b.innerText="/r/AnonDraw";b.href="http://www.reddit.com/r/AnonDraw";b.className="drawtogether-redditdrawings-title";for(b=0;b<a.length;b++)"self"!=a[b].data.thumbnail&&("default"!=a[b].data.thumbnail&&"nsfw"!=a[b].data.thumbnail)&&
this.redditDrawings.appendChild(this.createRedditPost(a[b].data))}}.bind(this));c.open("GET","http://www.reddit.com/r/AnonDraw/.json");c.send()};
DrawTogether.prototype.createRedditPost=function(c){var a=document.createElement("a");a.href="http://www.reddit.com"+c.permalink;a.target="_blank";a.className="drawtogether-redditpost";if("self"!==c.thumbnail&&"default"!==c.thumbnail&&"nsfw"!==c.thumbnail){var b=a.appendChild(document.createElement("img"));b.className="drawtogether-redditpost-thumb";b.src=c.thumbnail}else b=a.appendChild(document.createElement("div")),b.className="drawtogether-redditpost-thumbfiller",b.innerText="Selfpost";b=a.appendChild(document.createElement("span"));
b.className="drawtogether-redditpost-title";b.innerText=c.title;return a};
DrawTogether.prototype.createFAQDom=function(){var c=document.createElement("div");c.className="drawtogether-faq";for(var a=[{question:"What is anondraw?",answer:"It's a webapp where you can draw live with strangers or friends. There is also a gamemode."},{question:"What is that number with an R behind peoples names?",answer:"That is the amount of reputation someone has. The more they have the more benefits they get."},{question:"What benefits does reputation give you?",answer:"\n At "+this.KICKBAN_MIN_REP+
"+ reputation you can kickban people for a certain amount of time when they misbehave."},{question:"How do I get reputation?",answer:"Other people have to give you an upvote, every upvote is one reputation."}],b=0;b<a.length;b++){var e=c.appendChild(document.createElement("div"));e.className="drawtogether-question";var d=e.appendChild(document.createElement("h1"));d.className="drawtogether-question-question";d.innerText=a[b].question;d.textContent=a[b].question;e=e.appendChild(document.createElement("div"));
e.className="drawtogether-question-answer";for(var d=a[b].answer.split("\n"),f=0;f<d.length;f++){var l=e.appendChild(document.createElement("div"));l.innerText=d[f];l.textContent=d[f]}}return c};
DrawTogether.prototype.createControlArray=function(){return[{name:"home-button",type:"button",value:"",text:"Home",title:"Go to home menu",action:function(){this.openModeSelector()}.bind(this)},{name:"toggle-chat",type:"button",value:"",text:"Chat",title:"Toggle chat",action:this.toggleChat.bind(this)},{name:"toggle-info",type:"button",value:"",text:"Info",title:"Toggle room info",action:this.toggleInfo.bind(this)},{name:"name",type:"text",text:"Username",value:localStorage.getItem("drawtogether-name")||
"",title:"Change your name",action:function(c){console.log(c)}},{name:"name-button",type:"button",text:"Change name",action:this.changeName.bind(this)},{name:"room-button",type:"button",text:"Room",action:this.openRoomWindow.bind(this)},{name:"share-button",type:"button",text:"Put on imgur/reddit",action:this.openShareWindow.bind(this)},{name:"account",type:"button",text:"Account",action:this.openAccountWindow.bind(this)}]};
DrawTogether.prototype.utils={copy:function(c){var a={},b;for(b in c)a[b]="object"==typeof c[b]?this.copy(c[b]):c[b];return a},merge:function(c,a){"object"!=typeof c&&(c={});for(var b in a)"object"==typeof a[b]?c[b]=this.merge(c[b],a[b]):"undefined"==typeof c[b]&&(c[b]=a[b]);return c},distance:function(c,a,b,e){c-=b;a-=a;return Math.sqrt(c*c+a*a)}};function Gui(c){this.container=c}
Gui.prototype.prompt=function(c,a,b){"function"==typeof a&&(b=a,a="freepick");b="function"==typeof b?b:function(){};var e=this.container.appendChild(document.createElement("div")),d=e.appendChild(document.createElement("div")),f=d.appendChild(document.createElement("span")),l=d.appendChild(document.createElement("div"));e.className="gui-prompt-container";d.className="gui-prompt-content";f.className="gui-prompt-question";l.className="gui-prompt-answers";f.innerText=c;f.textContent=c;"freepick"==a&&
l.appendChild(this.createFreePick(c,function(c){b(c);this.container.removeChild(e)}.bind(this)));if("object"==typeof a&&"number"==typeof a.length)for(d=0;d<a.length;d++)"freepick"==a[d]?l.appendChild(this.createFreePick(c,function(c){b(c);this.container.removeChild(e)}.bind(this))):(f=l.appendChild(document.createElement("div")),f.className="gui-prompt-button gui-prompt-option-button",f.innerText=a[d],f.textContent=a[d],f.option=a[d],f.addEventListener("click",function(c){this.container.removeChild(e);
b(c.target.option)}.bind(this)))};Gui.prototype.createFreePick=function(c,a){var b=document.createElement("div"),e=b.appendChild(document.createElement("input"));e.className="gui-prompt-freepick-input";e.placeholder=c;e.addEventListener("keypress",function(c){13==c.keyCode&&a(e.value)});var d=b.appendChild(document.createElement("div"));d.className="gui-prompt-button gui-prompt-freepick-button";d.innerText="Submit";d.textContent="Submit";d.addEventListener("click",function(c){a(e.value)});return b};function Network(c){this.mainServer=c;this.socket;this.callbacks={}}Network.prototype.loadRoom=function(c,a){this.getServerFromRoom(c,function(b,e){b?a(b):(console.log("Room '"+c+"' is on server: "+e),this.changeServer(e),this.socket.emit("changeroom",c,a))}.bind(this))};
Network.prototype.getRooms=function(c){var a=new XMLHttpRequest;a.addEventListener("readystatechange",function(b){200==a.status&&4==a.readyState?(b=JSON.parse(a.responseText),c(null,b.rooms)):4==a.readyState&&c("There was an error trying to find a server to play on. Are you connected to the internet? Status code: "+a.status)});a.open("GET",this.mainServer+"/getrooms");a.send()};
Network.prototype.getServerFromRoom=function(c,a){var b=new XMLHttpRequest;b.addEventListener("readystatechange",function(c){200==b.status&&4==b.readyState?(c=JSON.parse(b.responseText),c.error?a("There was an error trying to find a server to play on. Server response: "+c.error):a(null,c.server)):4==b.readyState&&a("There was an error trying to find a server to play on. Are you connected to the internet? Status code: "+b.status)});b.open("GET",this.mainServer+"/getserver?room="+encodeURIComponent(c));
b.send()};Network.prototype.changeServer=function(c){this.socket&&this.socket.io.uri!==c&&(this.socket.destroy(),delete this.socket);this.socket||(this.socket=io("http://localhost:2586",{transports:["websocket"]}),this.reBindHandlers())};Network.prototype.on=function(c,a){this.callbacks[c]=this.callbacks[c]||[];-1===this.callbacks[c].indexOf(a)&&(this.callbacks[c].push(a),this.socket&&this.socket.on(c,a))};
Network.prototype.reBindHandlers=function(){if(this.socket&&!this.socket.DT_handlersBound){for(var c in this.callbacks)for(var a=0;a<this.callbacks[c].length;a++)this.socket.on(c,this.callbacks[c][a]);this.socket.DT_handlersBound=!0}};function Controls(c,a){this.controls=a||[];this.byName={};this.container=c;this.buildControls()}Controls.prototype.buildControls=function(){for(;this.container.firstChild;)this.container.removeChild(container.firstChild);for(var c=0;c<this.controls.length;c++){var a=this.createControl(this.controls[c]);this.container.appendChild(a.containerAppend);this.byName[this.controls[c].name]=a;"function"==typeof a.executeAfterAppend&&a.executeAfterAppend()}};
Controls.prototype.createControl=function(c){if("function"==typeof this.constructors[c.type])return this.constructors[c.type](c);console.error("Unknown control: "+c.type,c);return document.createTextNode("Unknown control: "+c.type)};Controls.prototype.constructors={};
Controls.prototype.constructors.button=function(c){var a=document.createElement("div");a.className=(c.classAppend||"")+"control-button";c.value&&(a.value=c.value);c.text&&a.appendChild(document.createTextNode(c.text));if(c.image){var b=a.appendChild(document.createElement("img"));b.src=c.image;b.alt=c.alt}c.title&&(a.title=c.title);a.addEventListener("click",function(b){c.action(a.value);b.preventDefault()});return{input:a,containerAppend:a}};
Controls.prototype.constructors.integer=function(c){var a=document.createElement("div");a.className=(c.classAppend||"")+"control-integer";var b=document.createElement("input");b.type="number";b.value=c.value;b.className=(c.classAppend||"")+"control-integer-input";c.text&&(b.placeholder=c.text);c.title&&(b.title=c.title);c.max&&(b.max=c.max);c.min&&(b.min=c.min);b.addEventListener("input",function(){c.action(b.value)});a.appendChild(this.button({text:"-",action:function(){var a=parseInt(b.max||Infinity),
d=parseInt(b.value)-1;b.value=Math.min(a,d);c.action(b.value)}}).containerAppend);a.appendChild(b);a.appendChild(this.button({text:"+",action:function(){var a=parseInt(b.max||Infinity),d=parseInt(b.value)+1;b.value=Math.min(a,d);c.action(b.value)}}).containerAppend);return{input:b,containerAppend:a}};
Controls.prototype.constructors.text=function(c){var a=document.createElement("input");a.type="text";a.value=c.value;a.className=(c.classAppend||"")+"control-text-input";c.text&&(a.placeholder=c.text);c.title&&(a.title=c.title);c.max&&(a.max=c.max);c.min&&(a.min=c.min);a.addEventListener("input",function(){c.action(a.value)});return{input:a,containerAppend:a}};
Controls.prototype.constructors.color=function(c){var a=document.createElement("input");a.type="text";a.value=c.value;a.className=(c.classAppend||"")+"control-color-input";return{input:a,containerAppend:a,executeAfterAppend:function(){$(a).spectrum({showAlpha:!0,showInput:!0,showInitial:!0,preferredFormat:"rgba",showPalette:!0,maxSelectionSize:32,clickoutFiresChange:!0,move:function(a){c.action(a.toHexString())}})}}};
function TiledCanvas(c,a){this.canvas=c;this.ctx=this.canvas.getContext("2d");this.leftTopY=this.leftTopX=0;this.zoom=1;this.affecting=[[0,0],[0,0]];this.chunks={};this.settings=this.normalizeDefaults(a,this.defaultSettings);this.contextQueue=[];this.context=this.createContext()}TiledCanvas.prototype.defaultSettings={chunkSize:256};TiledCanvas.prototype.cloneObject=function(c){var a={},b;for(b in c)a[b]="object"!==typeof c[b]||c[b]instanceof Array?c[b]:this.cloneObject(c[b]);return a};
TiledCanvas.prototype.normalizeDefaults=function(c,a){c=c||{};var b=this.cloneObject(c),e;for(e in a)b[e]="object"!==typeof a[e]||a[e]instanceof Array?c[e]||a[e]:this.normalizeDefaults(c[e]||{},a[e]);return b};
TiledCanvas.prototype.redraw=function(c){c||this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);var a=Math.floor(this.leftTopX/this.settings.chunkSize);c=Math.ceil((this.leftTopX+this.canvas.width/this.zoom)/this.settings.chunkSize);for(var b=Math.floor(this.leftTopY/this.settings.chunkSize),e=Math.ceil((this.leftTopY+this.canvas.height/this.zoom)/this.settings.chunkSize);a<c;a++)for(var d=b;d<e;d++)this.drawChunk(a,d)};
TiledCanvas.prototype.drawChunk=function(c,a){this.chunks[c]&&this.chunks[c][a]?this.ctx.drawImage(this.chunks[c][a].canvas,(c*this.settings.chunkSize-this.leftTopX)*this.zoom,(a*this.settings.chunkSize-this.leftTopY)*this.zoom,this.settings.chunkSize*this.zoom,this.settings.chunkSize*this.zoom):"function"==typeof this.requestUserChunk&&this.requestChunk(c,a)};TiledCanvas.prototype.goto=function(c,a){this.leftTopX=c;this.leftTopY=a;this.redraw()};
TiledCanvas.prototype.relativeZoom=function(c){this.zoom*=c;this.redraw()};TiledCanvas.prototype.absoluteZoom=function(c){this.zoom=c;this.redraw()};TiledCanvas.prototype.execute=function(){this.executeNoRedraw();this.redraw()};TiledCanvas.prototype.executeNoRedraw=function(){for(var c=this.affecting[0][0];c<this.affecting[1][0];c++)for(var a=this.affecting[0][1];a<this.affecting[1][1];a++)this.executeChunk(c,a);this.contextQueue=[]};
TiledCanvas.prototype.clearAll=function(){this.contextQueue=[];for(var c in this.chunks)this.clearChunkRow(c)};TiledCanvas.prototype.clearChunkRow=function(c){for(var a in this.chunks[c])this.clearChunk(c,a)};TiledCanvas.prototype.clearChunk=function(c,a){this.chunks[c][a].clearRect(c*this.settings.chunkSize,a*this.settings.chunkSize,this.chunks[c][a].canvas.width,this.chunks[c][a].canvas.height)};
TiledCanvas.prototype.requestChunk=function(c,a,b){"function"===typeof this.requestUserChunk&&(b=b||function(){},this.requestChunkCallbackList=this.requestChunkCallbackList||{},this.requestChunkCallbackList[c]&&this.requestChunkCallbackList[c][a]?this.requestChunkCallbackList[c][a].push(b):(this.requestChunkCallbackList[c]=this.requestChunkCallbackList[c]||{},this.requestChunkCallbackList[c][a]=[b],this.requestUserChunk(c,a,function(b){this.chunks[c][a]=this.newCtx(this.settings.chunkSize,this.settings.chunkSize,
-c*this.settings.chunkSize,-a*this.settings.chunkSize);this.chunks[c][a].drawImage(b,0,0);b=this.requestChunkCallbackList[c][a];for(var d=0;d<b.length;d++)b[d]();this.redraw();delete this.requestChunkCallbackList[c][a]}.bind(this))))};
TiledCanvas.prototype.executeChunk=function(c,a,b){this.chunks[c]=this.chunks[c]||[];this.chunks[c][a]=this.chunks[c][a];if(!this.chunks[c][a]){if("function"==typeof this.requestUserChunk){this.requestChunk(c,a,function(b){this.executeChunk(c,a,b)}.bind(this,this.copyArray(b||this.contextQueue)));return}this.chunks[c][a]=this.newCtx(this.settings.chunkSize,this.settings.chunkSize,-c*this.settings.chunkSize,-a*this.settings.chunkSize)}b=this.chunks[c][a];for(var e=0;e<this.contextQueue.length;e++)"function"===
typeof b[this.contextQueue[e][0]]?this.executeQueueOnChunk(b,this.contextQueue[e]):b[this.contextQueue[e][0]]=this.contextQueue[e][1]};TiledCanvas.prototype.executeQueueOnChunk=function(c,a){c[a[0]].apply(c,Array.prototype.slice.call(a,1))};
TiledCanvas.prototype.drawingRegion=function(c,a,b,e,d){d=d||0;this.affecting[0][0]=Math.floor((Math.min(c,b)-d)/this.settings.chunkSize);this.affecting[0][1]=Math.floor((Math.min(a,e)-d)/this.settings.chunkSize);this.affecting[1][0]=Math.ceil((Math.max(b,c)+d)/this.settings.chunkSize);this.affecting[1][1]=Math.ceil((Math.max(e,a)+d)/this.settings.chunkSize)};
TiledCanvas.prototype.newCtx=function(c,a,b,e){var d=document.createElement("canvas").getContext("2d");d.canvas.width=c;d.canvas.height=a;d.translate(b,e);return d};
TiledCanvas.prototype.createContext=function(){var c={},a=document.createElement("canvas").getContext("2d"),b;for(b in a)"function"===typeof a[b]?c[b]=function(c){this.contextQueue.push(arguments)}.bind(this,b):"object"!==typeof a[b]&&(c.__defineGetter__(b,function(c){for(var a=this.newCtx(),b=0;b<this.contextQueue.length;b++)"function"===typeof a[args[0]]?a[args[0]].apply(a,args.slice(1)):a[args[0]]=args[1];return a[c]}.bind(this,b)),c.__defineSetter__(b,function(c,a){this.contextQueue.push(arguments)}.bind(this,
b)));return c};
(function(c){"function"===typeof define&&define.amd?define(["jquery"],c):"object"==typeof exports&&"object"==typeof module?module.exports=c:c(jQuery)})(function(c,a){function b(a,b,d,e){for(var s=[],f=0;f<a.length;f++){var l=a[f];if(l){var g=tinycolor(l),x=0.5>g.toHsl().l?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light",x=x+(tinycolor.equals(b,l)?" sp-thumb-active":""),l=g.toString(e.preferredFormat||"rgb"),n=k?"background-color:"+g.toRgbString():"filter:"+g.toFilter();s.push('<span title="'+l+
'" data-color="'+g.toRgbString()+'" class="'+x+'"><span class="sp-thumb-inner" style="'+n+';" /></span>')}else s.push(c("<div />").append(c('<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>').attr("title",e.noColorSelectedText)).html())}return"<div class='sp-cf "+d+"'>"+s.join("")+"</div>"}function e(a,b){var d=c.extend({},n,a);d.callbacks={move:h(d.move,b),change:h(d.change,b),show:h(d.show,b),hide:h(d.hide,b),beforeShow:h(d.beforeShow,b)};return d}function d(d,
l){function n(){p.showPaletteOnly&&(p.showPalette=!0);Ba.text(p.showPaletteOnly?p.togglePaletteMoreText:p.togglePaletteLessText);if(p.palette){pa=p.palette.slice(0);fa=c.isArray(pa[0])?pa:[pa];qa={};for(var a=0;a<fa.length;a++)for(var b=0;b<fa[a].length;b++){var B=tinycolor(fa[a][b]).toRgbString();qa[B]=!0}}v.toggleClass("sp-flat",L);v.toggleClass("sp-input-disabled",!p.showInput);v.toggleClass("sp-alpha-enabled",p.showAlpha);v.toggleClass("sp-clear-enabled",X);v.toggleClass("sp-buttons-disabled",
!p.showButtons);v.toggleClass("sp-palette-buttons-disabled",!p.togglePaletteOnly);v.toggleClass("sp-palette-disabled",!p.showPalette);v.toggleClass("sp-palette-only",p.showPaletteOnly);v.toggleClass("sp-initial-disabled",!p.showInitial);v.addClass(p.className).addClass(p.containerClassName);I()}function h(){if(t&&window.localStorage){try{var a=window.localStorage[t].split(",#");1<a.length&&(delete window.localStorage[t],c.each(a,function(c,a){ea(a)}))}catch(b){}try{M=window.localStorage[t].split(";")}catch(B){}}}
function ea(a){if(Q){a=tinycolor(a).toRgbString();if(!qa[a]&&-1===c.inArray(a,M))for(M.push(a);M.length>Ua;)M.shift();if(t&&window.localStorage)try{window.localStorage[t]=M.join(";")}catch(b){}}}function Ka(){var c=[];if(p.showPalette)for(var a=0;a<M.length;a++){var b=tinycolor(M[a]).toRgbString();qa[b]||c.push(M[a])}return c.reverse().slice(0,p.maxSelectionSize)}function Aa(){var a=E(),B=c.map(fa,function(c,B){return b(c,a,"sp-palette-row sp-palette-row-"+B,p)});h();M&&B.push(b(Ka(),a,"sp-palette-row sp-palette-row-selection",
p));La.html(B.join(""))}function w(){if(p.showInitial){var c=Y,a=E();Ma.html(b([c,a],a,"sp-palette-row-initial",p))}}function K(){(0>=J||0>=N||0>=ra)&&I();v.addClass(Na);R=null;C.trigger("dragstart.spectrum",[E()])}function z(){v.removeClass(Na);C.trigger("dragstop.spectrum",[E()])}function V(){var c=S.val();null!==c&&""!==c||!X?(c=tinycolor(c),c.isValid()?(T(c),H(!0)):S.addClass("sp-validation-error")):(T(null),H(!0))}function sa(){r?Z():na()}function na(){var a=c.Event("beforeShow.spectrum");if(r)I();
else if(C.trigger(a,[E()]),!1!==A.beforeShow(E())&&!a.isDefaultPrevented()){for(a=0;a<u.length;a++)u[a]&&u[a].hide();r=!0;c(Ca).bind("click.spectrum",za);c(window).bind("resize.spectrum",aa);ba.addClass("sp-active");v.removeClass("sp-hidden");I();P();Y=E();w();A.show(Y);C.trigger("show.spectrum",[Y])}}function za(c){2!=c.button&&(Va?H(!0):T(Y,!0),Z())}function Z(){r&&!L&&(r=!1,c(Ca).unbind("click.spectrum",za),c(window).unbind("resize.spectrum",aa),ba.removeClass("sp-active"),v.addClass("sp-hidden"),
A.hide(E()),C.trigger("hide.spectrum",[E()]))}function T(c,a){if(tinycolor.equals(c,E()))P();else{var b,B;!c&&X?U=!0:(U=!1,b=tinycolor(c),B=b.toHsv(),ga=B.h%360/360,ha=B.s,ia=B.v,O=B.a);P();b&&(b.isValid()&&!a)&&(ja=Da||b.getFormat())}}function E(c){c=c||{};return X&&U?null:tinycolor.fromRatio({h:ga,s:ha,v:ia,a:Math.round(100*O)/100},{format:c.format||ja})}function ca(){P();A.move(E());C.trigger("move.spectrum",[E()])}function P(){S.removeClass("sp-validation-error");y();var c=tinycolor.fromRatio({h:ga,
s:1,v:1});ta.css("background-color",c.toHexString());c=ja;!(1>O)||0===O&&"name"===c||"hex"!==c&&"hex3"!==c&&"hex6"!==c&&"name"!==c||(c="rgb");var a=E({format:c}),b="";da.removeClass("sp-clear-display");da.css("background-color","transparent");if(!a&&X)da.addClass("sp-clear-display");else{var b=a.toHexString(),B=a.toRgbString();k||1===a.alpha?da.css("background-color",B):(da.css("background-color","transparent"),da.css("filter",a.toFilter()));if(p.showAlpha){B=a.toRgb();B.a=0;var B=tinycolor(B).toRgbString(),
d="linear-gradient(left, "+B+", "+b+")";s?ka.css("filter",tinycolor(B).toFilter({gradientType:1},b)):(ka.css("background","-webkit-"+d),ka.css("background","-moz-"+d),ka.css("background","-ms-"+d),ka.css("background","linear-gradient(to right, "+B+", "+b+")"))}b=a.toString(c)}p.showInput&&S.val(b);p.showPalette&&Aa();w()}function y(){var c=ha,a=ia;X&&U?(ua.hide(),va.hide(),wa.hide()):(ua.show(),va.show(),wa.show(),c*=N,a=J-a*J,c=Math.max(-D,Math.min(N-D,c-D)),a=Math.max(-D,Math.min(J-D,a-D)),wa.css({top:a+
"px",left:c+"px"}),ua.css({left:O*B-Oa/2+"px"}),va.css({top:ga*ra-Pa+"px"}))}function H(c){var a=E(),b="",B=!tinycolor.equals(a,Y);a&&(b=a.toString(ja),ea(a));xa&&C.val(b);c&&B&&(A.change(a),C.trigger("change",[a]))}function I(){N=ta.width();J=ta.height();D=wa.height();Ea.width();ra=Ea.height();Pa=va.height();B=Qa.width();Oa=ua.width();L||(v.css("position","absolute"),p.offset?v.offset(p.offset):v.offset(f(v,la)));y();p.showPalette&&Aa();C.trigger("reflow.spectrum")}function Fa(){Z();Ga=!0;C.attr("disabled",
!0);la.addClass("sp-disabled")}var p=e(l,d),L=p.flat,Q=p.showSelectionPalette,t=p.localStorageKey,F=p.theme,A=p.callbacks,aa=q(I,10),r=!1,N=0,J=0,D=0,ra=0,B=0,Oa=0,Pa=0,ga=0,ha=0,ia=0,O=1,pa=[],fa=[],qa={},M=p.selectionPalette.slice(0),Ua=p.maxSelectionSize,Na="sp-dragging",R=null,Ca=d.ownerDocument,C=c(d),Ga=!1,v=c(W,Ca).addClass(F),Wa=v.find(".sp-picker-container"),ta=v.find(".sp-color"),wa=v.find(".sp-dragger"),Ea=v.find(".sp-hue"),va=v.find(".sp-slider"),ka=v.find(".sp-alpha-inner"),Qa=v.find(".sp-alpha"),
ua=v.find(".sp-alpha-handle"),S=v.find(".sp-input"),La=v.find(".sp-palette"),Ma=v.find(".sp-initial"),Ra=v.find(".sp-cancel"),Ha=v.find(".sp-clear"),Sa=v.find(".sp-choose"),Ba=v.find(".sp-palette-toggle"),xa=C.is("input"),Xa=xa&&x&&"color"===C.attr("type"),Ia=xa&&!L,ba=Ia?c(G).addClass(F).addClass(p.className).addClass(p.replacerClassName):c([]),la=Ia?ba:C,da=ba.find(".sp-preview-inner"),ma=p.color||xa&&C.val(),Y=!1,Da=p.preferredFormat,ja=Da,Va=!p.showButtons||p.clickoutFiresChange,U=!ma,X=p.allowEmpty&&
!Xa;(function(){function a(b){b.data&&b.data.ignore?(T(c(b.target).closest(".sp-thumb-el").data("color")),ca()):(T(c(b.target).closest(".sp-thumb-el").data("color")),ca(),H(!0),p.hideAfterPaletteSelect&&Z());return!1}s&&v.find("*:not(input)").attr("unselectable","on");n();Ia&&C.after(ba).hide();X||Ha.hide();if(L)C.after(v).hide();else{var b="parent"===p.appendTo?C.parent():c(p.appendTo);1!==b.length&&(b=c("body"));b.append(v)}h();la.bind("click.spectrum touchstart.spectrum",function(a){Ga||sa();a.stopPropagation();
c(a.target).is("input")||a.preventDefault()});(C.is(":disabled")||!0===p.disabled)&&Fa();v.click(g);S.change(V);S.bind("paste",function(){setTimeout(V,1)});S.keydown(function(c){13==c.keyCode&&V()});Ra.text(p.cancelText);Ra.bind("click.spectrum",function(c){c.stopPropagation();c.preventDefault();T(Y,!0);Z()});Ha.attr("title",p.clearText);Ha.bind("click.spectrum",function(c){c.stopPropagation();c.preventDefault();U=!0;ca();L&&H(!0)});Sa.text(p.chooseText);Sa.bind("click.spectrum",function(c){c.stopPropagation();
c.preventDefault();S.hasClass("sp-validation-error")||(H(!0),Z())});Ba.text(p.showPaletteOnly?p.togglePaletteMoreText:p.togglePaletteLessText);Ba.bind("click.spectrum",function(c){c.stopPropagation();c.preventDefault();p.showPaletteOnly=!p.showPaletteOnly;p.showPaletteOnly||L||v.css("left","-="+(Wa.outerWidth(!0)+5));n()});m(Qa,function(c,a,b){O=c/B;U=!1;b.shiftKey&&(O=Math.round(10*O)/10);ca()},K,z);m(Ea,function(c,a){ga=parseFloat(a/ra);U=!1;p.showAlpha||(O=1);ca()},K,z);m(ta,function(c,a,b){b.shiftKey?
R||(b=J-ia*J,R=Math.abs(c-ha*N)>Math.abs(a-b)?"x":"y"):R=null;b=!R||"y"===R;R&&"x"!==R||(ha=parseFloat(c/N));b&&(ia=parseFloat((J-a)/J));U=!1;p.showAlpha||(O=1);ca()},K,z);ma?(T(ma),P(),ja=Da||tinycolor(ma).format,ea(ma)):P();L&&na();b=s?"mousedown.spectrum":"click.spectrum touchstart.spectrum";La.delegate(".sp-thumb-el",b,a);Ma.delegate(".sp-thumb-el:nth-child(1)",b,{ignore:!0},a)})();var ya={show:na,hide:Z,toggle:sa,reflow:I,option:function(b,B){if(b===a)return c.extend({},p);if(B===a)return p[b];
p[b]=B;n()},enable:function(){Ga=!1;C.attr("disabled",!1);la.removeClass("sp-disabled")},disable:Fa,offset:function(c){p.offset=c;I()},set:function(c){T(c);H()},get:E,destroy:function(){C.show();la.unbind("click.spectrum touchstart.spectrum");v.remove();ba.remove();u[ya.id]=null},container:v};ya.id=u.push(ya)-1;return ya}function f(a,b){var d=a.outerWidth(),k=a.outerHeight(),e=b.outerHeight(),s=a[0].ownerDocument,f=s.documentElement,l=f.clientWidth+c(s).scrollLeft(),s=f.clientHeight+c(s).scrollTop(),
f=b.offset();f.top+=e;f.left-=Math.min(f.left,f.left+d>l&&l>d?Math.abs(f.left+d-l):0);f.top-=Math.min(f.top,f.top+k>s&&s>k?Math.abs(k+e-0):0);return f}function l(){}function g(c){c.stopPropagation()}function h(c,a){var b=Array.prototype.slice,d=b.call(arguments,2);return function(){return c.apply(a,d.concat(b.call(arguments)))}}function m(a,b,d,k){function e(c){c.stopPropagation&&c.stopPropagation();c.preventDefault&&c.preventDefault();c.returnValue=!1}function f(c){if(x){if(s&&9>g.documentMode&&
!c.button)return l();var d=c.originalEvent&&c.originalEvent.touches,k=d?d[0].pageY:c.pageY,d=Math.max(0,Math.min((d?d[0].pageX:c.pageX)-n.left,W)),k=Math.max(0,Math.min(k-n.top,h));q&&e(c);b.apply(a,[d,k,c])}}function l(){x&&(c(g).unbind(G),c(g.body).removeClass("sp-dragging"),k.apply(a,arguments));x=!1}b=b||function(){};d=d||function(){};k=k||function(){};var g=document,x=!1,n={},h=0,W=0,q="ontouchstart"in window,G={};G.selectstart=e;G.dragstart=e;G["touchmove mousemove"]=f;G["touchend mouseup"]=
l;c(a).bind("touchstart mousedown",function(b){(b.which?3==b.which:2==b.button)||x||!1===d.apply(a,arguments)||(x=!0,h=c(a).height(),W=c(a).width(),n=c(a).offset(),c(g).bind(G),c(g.body).addClass("sp-dragging"),q||f(b),e(b))})}function q(c,a,b){var d;return function(){var k=this,e=arguments,f=function(){d=null;c.apply(k,e)};b&&clearTimeout(d);if(b||!d)d=setTimeout(f,a)}}var n={beforeShow:l,move:l,change:l,show:l,hide:l,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!1,
showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:["#ffffff #000000 #ff0000 #ff8000 #ffff00 #008000 #0000ff #4b0082 #9400d3".split(" ")],
selectionPalette:[],disabled:!1,offset:null},u=[],s=!!/msie/i.exec(window.navigator.userAgent),k=function(){var c=document.createElement("div").style;c.cssText="background-color:rgba(0,0,0,.5)";return!!~(""+c.backgroundColor).indexOf("rgba")||!!~(""+c.backgroundColor).indexOf("hsla")}(),x=function(){var a=c("<input type='color' value='!' />")[0];return"color"===a.type&&"!"!==a.value}(),G="<div class='sp-replacer'><div class='sp-preview'><div class='sp-preview-inner'></div></div><div class='sp-dd'>&#9660;</div></div>",
W=function(){var c="";if(s)for(var a=1;6>=a;a++)c+="<div class='sp-"+a+"'></div>";return["<div class='sp-container sp-hidden'><div class='sp-palette-container'><div class='sp-palette sp-thumb sp-cf'></div><div class='sp-palette-button-container sp-cf'><button type='button' class='sp-palette-toggle'></button></div></div><div class='sp-picker-container'><div class='sp-top sp-cf'><div class='sp-fill'></div><div class='sp-top-inner'><div class='sp-color'><div class='sp-sat'><div class='sp-val'><div class='sp-dragger'></div></div></div></div><div class='sp-clear sp-clear-display'></div><div class='sp-hue'><div class='sp-slider'></div>",
c,"</div></div><div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div></div><div class='sp-input-container sp-cf'><input class='sp-input' type='text' spellcheck='false'  /></div><div class='sp-initial sp-thumb sp-cf'></div><div class='sp-button-container sp-cf'><a class='sp-cancel' href='#'></a><button type='button' class='sp-choose'></button></div></div></div>"].join("")}();c.fn.spectrum=function(a,b){if("string"==typeof a){var k=this,e=Array.prototype.slice.call(arguments,
1);this.each(function(){var b=u[c(this).data("spectrum.id")];if(b){var d=b[a];if(!d)throw Error("Spectrum: no such method: '"+a+"'");"get"==a?k=b.get():"container"==a?k=b.container:"option"==a?k=b.option.apply(b,e):"destroy"==a?(b.destroy(),c(this).removeData("spectrum.id")):d.apply(b,e)}});return k}return this.spectrum("destroy").each(function(){var b=c.extend({},a,c(this).data()),b=d(this,b);c(this).data("spectrum.id",b.id)})};c.fn.spectrum.load=!0;c.fn.spectrum.loadOpts={};c.fn.spectrum.draggable=
m;c.fn.spectrum.defaults=n;c.spectrum={};c.spectrum.localization={};c.spectrum.palettes={};c.fn.spectrum.processNativeColorInputs=function(){x||c("input[type=color]").spectrum({preferredFormat:"hex6"})};(function(){function c(a,b,d){a=y(a,255);b=y(b,255);d=y(d,255);var k=A(a,b,d),e=F(a,b,d),f,s=(k+e)/2;if(k==e)f=e=0;else{var l=k-e,e=0.5<s?l/(2-k-e):l/(k+e);switch(k){case a:f=(b-d)/l+(b<d?6:0);break;case b:f=(d-a)/l+2;break;case d:f=(a-b)/l+4}f/=6}return{h:f,s:e,l:s}}function a(c,b,d){function k(c,
a,b){0>b&&(b+=1);1<b&&(b-=1);return b<1/6?c+6*(a-c)*b:0.5>b?a:b<2/3?c+6*(a-c)*(2/3-b):c}c=y(c,360);b=y(b,100);d=y(d,100);if(0===b)d=b=c=d;else{var e=0.5>d?d*(1+b):d+b-d*b,f=2*d-e;d=k(f,e,c+1/3);b=k(f,e,c);c=k(f,e,c-1/3)}return{r:255*d,g:255*b,b:255*c}}function b(c,a,d){c=y(c,255);a=y(a,255);d=y(d,255);var k=A(c,a,d),e=F(c,a,d),f,s=k-e;if(k==e)f=0;else{switch(k){case c:f=(a-d)/s+(a<d?6:0);break;case a:f=(d-c)/s+2;break;case d:f=(c-a)/s+4}f/=6}return{h:f,s:0===k?0:s/k,v:k}}function d(c,a,b,k){c=[H(t(c).toString(16)),
H(t(a).toString(16)),H(t(b).toString(16))];return k&&c[0].charAt(0)==c[0].charAt(1)&&c[1].charAt(0)==c[1].charAt(1)&&c[2].charAt(0)==c[2].charAt(1)?c[0].charAt(0)+c[1].charAt(0)+c[2].charAt(0):c.join("")}function k(c,a,b,d){return[H(Math.round(255*parseFloat(d)).toString(16)),H(t(c).toString(16)),H(t(a).toString(16)),H(t(b).toString(16))].join("")}function e(c,a){a=0===a?0:a||10;var b=r(c).toHsl();b.s-=a/100;b.s=F(1,A(0,b.s));return r(b)}function f(c,a){a=0===a?0:a||10;var b=r(c).toHsl();b.s+=a/100;
b.s=F(1,A(0,b.s));return r(b)}function s(c){return r(c).desaturate(100)}function l(c,a){a=0===a?0:a||10;var b=r(c).toHsl();b.l+=a/100;b.l=F(1,A(0,b.l));return r(b)}function g(c,a){a=0===a?0:a||10;var b=r(c).toRgb();b.r=A(0,F(255,b.r-t(255*-(a/100))));b.g=A(0,F(255,b.g-t(255*-(a/100))));b.b=A(0,F(255,b.b-t(255*-(a/100))));return r(b)}function x(c,a){a=0===a?0:a||10;var b=r(c).toHsl();b.l-=a/100;b.l=F(1,A(0,b.l));return r(b)}function n(c,a){var b=r(c).toHsl(),d=(t(b.h)+a)%360;b.h=0>d?360+d:d;return r(b)}
function h(c){c=r(c).toHsl();c.h=(c.h+180)%360;return r(c)}function W(c){var a=r(c).toHsl(),b=a.h;return[r(c),r({h:(b+120)%360,s:a.s,l:a.l}),r({h:(b+240)%360,s:a.s,l:a.l})]}function q(c){var a=r(c).toHsl(),b=a.h;return[r(c),r({h:(b+90)%360,s:a.s,l:a.l}),r({h:(b+180)%360,s:a.s,l:a.l}),r({h:(b+270)%360,s:a.s,l:a.l})]}function G(c){var a=r(c).toHsl(),b=a.h;return[r(c),r({h:(b+72)%360,s:a.s,l:a.l}),r({h:(b+216)%360,s:a.s,l:a.l})]}function u(c,a,b){a=a||6;b=b||30;var d=r(c).toHsl();b=360/b;c=[r(c)];for(d.h=
(d.h-(b*a>>1)+720)%360;--a;)d.h=(d.h+b)%360,c.push(r(d));return c}function m(c,a){a=a||6;for(var b=r(c).toHsv(),d=b.h,k=b.s,b=b.v,e=[],f=1/a;a--;)e.push(r({h:d,s:k,v:b})),b=(b+f)%1;return e}function P(c){c=parseFloat(c);if(isNaN(c)||0>c||1<c)c=1;return c}function y(c,a){"string"==typeof c&&(-1!=c.indexOf(".")&&1===parseFloat(c))&&(c="100%");var b="string"===typeof c&&-1!=c.indexOf("%");c=F(a,A(0,parseFloat(c)));b&&(c=parseInt(c*a,10)/100);return 1E-6>Q.abs(c-a)?1:c%a/parseFloat(a)}function H(c){return 1==
c.length?"0"+c:""+c}function I(c){1>=c&&(c=100*c+"%");return c}var Fa=/^[\s,#]+/,p=/\s+$/,L=0,Q=Math,t=Q.round,F=Q.min,A=Q.max,aa=Q.random,r=function B(c,b){var d,k,e,f,s;c=c?c:"";b=b||{};if(c instanceof B)return c;if(!(this instanceof B))return new B(c,b);k=c;s={r:0,g:0,b:0};var l=1;e=d=!1;if("string"==typeof k)a:{k=k.replace(Fa,"").replace(p,"").toLowerCase();var g=!1;if(N[k])k=N[k],g=!0;else if("transparent"==k){k={r:0,g:0,b:0,a:0,format:"name"};break a}k=(f=D.rgb.exec(k))?{r:f[1],g:f[2],b:f[3]}:
(f=D.rgba.exec(k))?{r:f[1],g:f[2],b:f[3],a:f[4]}:(f=D.hsl.exec(k))?{h:f[1],s:f[2],l:f[3]}:(f=D.hsla.exec(k))?{h:f[1],s:f[2],l:f[3],a:f[4]}:(f=D.hsv.exec(k))?{h:f[1],s:f[2],v:f[3]}:(f=D.hsva.exec(k))?{h:f[1],s:f[2],v:f[3],a:f[4]}:(f=D.hex8.exec(k))?{a:parseInt(f[1],16)/255,r:parseInt(f[2],16),g:parseInt(f[3],16),b:parseInt(f[4],16),format:g?"name":"hex8"}:(f=D.hex6.exec(k))?{r:parseInt(f[1],16),g:parseInt(f[2],16),b:parseInt(f[3],16),format:g?"name":"hex"}:(f=D.hex3.exec(k))?{r:parseInt(f[1]+""+f[1],
16),g:parseInt(f[2]+""+f[2],16),b:parseInt(f[3]+""+f[3],16),format:g?"name":"hex"}:!1}if("object"==typeof k){if(k.hasOwnProperty("r")&&k.hasOwnProperty("g")&&k.hasOwnProperty("b"))s={r:255*y(k.r,255),g:255*y(k.g,255),b:255*y(k.b,255)},d=!0,e="%"===String(k.r).substr(-1)?"prgb":"rgb";else if(k.hasOwnProperty("h")&&k.hasOwnProperty("s")&&k.hasOwnProperty("v")){k.s=I(k.s);k.v=I(k.v);e=k.h;g=k.s;s=k.v;e=6*y(e,360);g=y(g,100);s=y(s,100);d=Q.floor(e);var x=e-d;e=s*(1-g);f=s*(1-x*g);g=s*(1-(1-x)*g);d%=6;
s={r:255*[s,f,e,e,g,s][d],g:255*[g,s,s,f,e,e][d],b:255*[e,e,g,s,s,f][d]};d=!0;e="hsv"}else k.hasOwnProperty("h")&&(k.hasOwnProperty("s")&&k.hasOwnProperty("l"))&&(k.s=I(k.s),k.l=I(k.l),s=a(k.h,k.s,k.l),d=!0,e="hsl");k.hasOwnProperty("a")&&(l=k.a)}l=P(l);k=k.format||e;e=F(255,A(s.r,0));f=F(255,A(s.g,0));s=F(255,A(s.b,0));this._originalInput=c;this._r=e;this._g=f;this._b=s;this._a=l;this._roundA=t(100*this._a)/100;this._format=b.format||k;this._gradientType=b.gradientType;1>this._r&&(this._r=t(this._r));
1>this._g&&(this._g=t(this._g));1>this._b&&(this._b=t(this._b));this._ok=d;this._tc_id=L++};r.prototype={isDark:function(){return 128>this.getBrightness()},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var c=this.toRgb();return(299*c.r+587*c.g+114*c.b)/1E3},setAlpha:function(c){this._a=P(c);this._roundA=t(100*
this._a)/100;return this},toHsv:function(){var c=b(this._r,this._g,this._b);return{h:360*c.h,s:c.s,v:c.v,a:this._a}},toHsvString:function(){var c=b(this._r,this._g,this._b),a=t(360*c.h),d=t(100*c.s),c=t(100*c.v);return 1==this._a?"hsv("+a+", "+d+"%, "+c+"%)":"hsva("+a+", "+d+"%, "+c+"%, "+this._roundA+")"},toHsl:function(){var a=c(this._r,this._g,this._b);return{h:360*a.h,s:a.s,l:a.l,a:this._a}},toHslString:function(){var a=c(this._r,this._g,this._b),b=t(360*a.h),d=t(100*a.s),a=t(100*a.l);return 1==
this._a?"hsl("+b+", "+d+"%, "+a+"%)":"hsla("+b+", "+d+"%, "+a+"%, "+this._roundA+")"},toHex:function(c){return d(this._r,this._g,this._b,c)},toHexString:function(c){return"#"+this.toHex(c)},toHex8:function(){return k(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:t(this._r),g:t(this._g),b:t(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+t(this._r)+", "+t(this._g)+", "+t(this._b)+")":"rgba("+t(this._r)+", "+t(this._g)+
", "+t(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:t(100*y(this._r,255))+"%",g:t(100*y(this._g,255))+"%",b:t(100*y(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+t(100*y(this._r,255))+"%, "+t(100*y(this._g,255))+"%, "+t(100*y(this._b,255))+"%)":"rgba("+t(100*y(this._r,255))+"%, "+t(100*y(this._g,255))+"%, "+t(100*y(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":1>this._a?!1:J[d(this._r,this._g,
this._b,!0)]||!1},toFilter:function(c){var a="#"+k(this._r,this._g,this._b,this._a),b=a,d=this._gradientType?"GradientType = 1, ":"";c&&(b=r(c).toHex8String());return"progid:DXImageTransform.Microsoft.gradient("+d+"startColorstr="+a+",endColorstr="+b+")"},toString:function(c){var a=!!c;c=c||this._format;var b=!1,d=1>this._a&&0<=this._a;if(!a&&d&&("hex"===c||"hex6"===c||"hex3"===c||"name"===c))return"name"===c&&0===this._a?this.toName():this.toRgbString();"rgb"===c&&(b=this.toRgbString());"prgb"===
c&&(b=this.toPercentageRgbString());if("hex"===c||"hex6"===c)b=this.toHexString();"hex3"===c&&(b=this.toHexString(!0));"hex8"===c&&(b=this.toHex8String());"name"===c&&(b=this.toName());"hsl"===c&&(b=this.toHslString());"hsv"===c&&(b=this.toHsvString());return b||this.toHexString()},_applyModification:function(c,a){var b=c.apply(null,[this].concat([].slice.call(a)));this._r=b._r;this._g=b._g;this._b=b._b;this.setAlpha(b._a);return this},lighten:function(){return this._applyModification(l,arguments)},
brighten:function(){return this._applyModification(g,arguments)},darken:function(){return this._applyModification(x,arguments)},desaturate:function(){return this._applyModification(e,arguments)},saturate:function(){return this._applyModification(f,arguments)},greyscale:function(){return this._applyModification(s,arguments)},spin:function(){return this._applyModification(n,arguments)},_applyCombination:function(c,a){return c.apply(null,[this].concat([].slice.call(a)))},analogous:function(){return this._applyCombination(u,
arguments)},complement:function(){return this._applyCombination(h,arguments)},monochromatic:function(){return this._applyCombination(m,arguments)},splitcomplement:function(){return this._applyCombination(G,arguments)},triad:function(){return this._applyCombination(W,arguments)},tetrad:function(){return this._applyCombination(q,arguments)}};r.fromRatio=function(c,a){if("object"==typeof c){var b={},d;for(d in c)c.hasOwnProperty(d)&&(b[d]="a"===d?c[d]:I(c[d]));c=b}return r(c,a)};r.equals=function(c,
a){return c&&a?r(c).toRgbString()==r(a).toRgbString():!1};r.random=function(){return r.fromRatio({r:aa(),g:aa(),b:aa()})};r.mix=function(c,a,b){b=0===b?0:b||50;c=r(c).toRgb();a=r(a).toRgb();b/=100;var d=2*b-1,k=a.a-c.a,d=((-1==d*k?d:(d+k)/(1+d*k))+1)/2,k=1-d;return r({r:a.r*d+c.r*k,g:a.g*d+c.g*k,b:a.b*d+c.b*k,a:a.a*b+c.a*(1-b)})};r.readability=function(c,a){var b=r(c),d=r(a),k=b.toRgb(),f=d.toRgb(),b=b.getBrightness(),d=d.getBrightness(),k=Math.max(k.r,f.r)-Math.min(k.r,f.r)+Math.max(k.g,f.g)-Math.min(k.g,
f.g)+Math.max(k.b,f.b)-Math.min(k.b,f.b);return{brightness:Math.abs(b-d),color:k}};r.isReadable=function(c,a){var b=r.readability(c,a);return 125<b.brightness&&500<b.color};r.mostReadable=function(c,a){for(var b=null,d=0,k=!1,f=0;f<a.length;f++){var e=r.readability(c,a[f]),s=125<e.brightness&&500<e.color,e=3*(e.brightness/125)+e.color/500;if(s&&!k||s&&k&&e>d||!s&&!k&&e>d)k=s,d=e,b=r(a[f])}return b};var N=r.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",
beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",
darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",
indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",
magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",
paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",
thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},J=r.hexNames=function(c){var a={},b;for(b in c)c.hasOwnProperty(b)&&(a[c[b]]=b);return a}(N),D={rgb:RegExp("rgb[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),rgba:RegExp("rgba[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),
hsl:RegExp("hsl[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),hsla:RegExp("hsla[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),hsv:RegExp("hsv[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),
hsva:RegExp("hsva[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};window.tinycolor=r})();c(function(){c.fn.spectrum.load&&c.fn.spectrum.processNativeColorInputs()})});
function Paint(c,a){this.eventHandlers={};this.settings=this.utils.merge(this.utils.copy(a),this.defaultSettings);this.container=c;this.addCanvas(c);this.resize();this.controlContainer=c.appendChild(document.createElement("div"));this.controlContainer.className="control-container";this.controls=new Controls(this.controlContainer,this.createControlArray());this.toolButtons=["grab","line","brush","picker"];this.changeTool("brush");this.changeColor("#000000");this.changeToolSize(5);$(this.controls.byName["tool-color"].input).spectrum("set",
this.current_color);this.localDrawings=[];window.addEventListener("resize",this.resize.bind(this))}Paint.prototype.defaultSettings={maxSize:50,maxLineLength:200};
Paint.prototype.addCanvas=function(c){var a=c.appendChild(this.createCanvas("public")),b=c.appendChild(this.createCanvas("local"));c=c.appendChild(this.createCanvas("effect"));this.public=new TiledCanvas(a);this.local=new TiledCanvas(b);this.effectsCanvas=c;this.effectsCanvasCtx=c.getContext("2d");this.publicCtx=a.getContext("2d");this.localCtx=b.getContext("2d");c.addEventListener("mousedown",this.exectool.bind(this));c.addEventListener("mousemove",this.exectool.bind(this));c.addEventListener("mouseup",
this.exectool.bind(this));c.addEventListener("touchstart",this.exectool.bind(this));c.addEventListener("touchmove",this.exectool.bind(this));c.addEventListener("touchend",this.exectool.bind(this));this.canvasArray=[a,b,c];this.lastCanvas=b};
Paint.prototype.newCanvasOnTop=function(c){c=this.createCanvas(c||"foreign");this.lastCanvas.parentNode.insertBefore(c,this.lastCanvas.nextSibling);this.lastCanvas=c;this.canvasArray.push(c);c.leftTopX=this.public.leftTopX;c.leftTopY=this.public.leftTopY;this.resize();return c};Paint.prototype.clear=function(){this.public.clearAll();this.local.clearAll();this.public.redraw();this.local.redraw()};
Paint.prototype.createCanvas=function(c){var a=document.createElement("canvas");a.className="paint-canvas paint-canvas-"+c;return a};Paint.prototype.resize=function(){for(var c=0;c<this.canvasArray.length;c++)this.canvasArray[c].width=this.canvasArray[c].offsetWidth,this.canvasArray[c].height=this.canvasArray[c].offsetHeight;this.public.redraw();this.local.redraw()};
Paint.prototype.redrawLocalDrawings=function(){this.redrawLocalsNeeded=!0;this.drawDrawingTimeout||(this.drawDrawingTimeout=setTimeout(this.redrawTimeout.bind(this),30))};Paint.prototype.redrawTimeout=function(){requestAnimationFrame(this.redrawLoop.bind(this))};Paint.prototype.redrawLoop=function(){for(var c in this.redrawLayers)this[c].redraw();this.redrawLocalsNeeded&&this.redrawLocals();delete this.drawDrawingTimeout;delete this.redrawLocalsNeeded};
Paint.prototype.redrawLocals=function(c){this.local.clearAll();this.localDrawings.forEach(this.drawDrawing.bind(this,"local"));this.local.redraw()};Paint.prototype.removeLocalDrawing=function(c){c=this.localDrawings.indexOf(c);this.localDrawings.splice(c,1);this.redrawLocalDrawings()};Paint.prototype.addPublicDrawing=function(c){this.drawDrawing("public",c)};
Paint.prototype.addUserDrawing=function(c){this.drawDrawing("local",c);this.localDrawings.push(c);this.dispatchEvent({type:"userdrawing",drawing:c,removeDrawing:this.removeLocalDrawing.bind(this,c)})};Paint.prototype.drawDrawings=function(c,a){for(var b=0;b<a.length;b++)this.drawFunctions[a[b].type](this[c].context,a[b],this[c]);this[c].redraw(!0)};
Paint.prototype.drawDrawing=function(c,a){this.drawFunctions[a.type](this[c].context,a,this[c]);this.redrawLayers=this.redrawLayers||{};this.redrawLayers[c]=!0;this.drawDrawingTimeout||(this.drawDrawingTimeout=setTimeout(this.redrawLoop.bind(this),30))};Paint.prototype.exectool=function(c){c&&"function"==typeof c.preventDefault&&c.preventDefault();if("function"==typeof this.tools[this.current_tool])this.tools[this.current_tool](this,c)};
Paint.prototype.changeTool=function(c){this.exectool("remove");this.current_tool=c;this.effectsCanvasCtx.clearRect(0,0,this.effectsCanvas.width,this.effectsCanvas.height);for(var a=0;a<this.toolButtons.length;a++)this.controls.byName[this.toolButtons[a]].input.classList.remove("paint-selected-tool");this.controls.byName[c].input.classList.add("paint-selected-tool")};Paint.prototype.changeColor=function(c){this.current_color=c;this.effectsCanvasCtx.clearRect(0,0,this.effectsCanvas.width,this.effectsCanvas.height)};
Paint.prototype.changeToolSize=function(c){c>this.settings.maxSize&&(c=this.settings.maxSize);this.current_size=parseInt(c);this.effectsCanvasCtx.clearRect(0,0,this.effectsCanvas.width,this.effectsCanvas.height)};Paint.prototype.setColor=function(c){this.changeColor(c);$(this.controls.byName["tool-color"].input).spectrum("set",this.current_color)};
Paint.prototype.createControlArray=function(){return[{name:"grab",type:"button",image:"images/icons/grab.png",title:"Change tool to grab",value:"grab",action:this.changeTool.bind(this)},{name:"line",type:"button",image:"images/icons/line.png",title:"Change tool to line",value:"line",action:this.changeTool.bind(this)},{name:"brush",type:"button",image:"images/icons/brush.png",title:"Change tool to brush",value:"brush",action:this.changeTool.bind(this)},{name:"picker",type:"button",image:"images/icons/picker.png",
title:"Change tool to picker",value:"picker",action:this.changeTool.bind(this)},{name:"tool-size",type:"integer",text:"Tool size",min:1,max:50,value:5,title:"Change the size of the tool",action:this.changeToolSize.bind(this)},{name:"zoom-in",type:"button",image:"images/icons/zoomin.png",title:"Zoom in",value:2,action:this.zoom.bind(this)},{name:"zoom-out",type:"button",image:"images/icons/zoomout.png",title:"Zoom out",value:0.5,action:this.zoom.bind(this)},{name:"tool-color",type:"color",text:"Tool color",
value:"#FFFFFF",title:"Change the color of the tool",action:this.changeColor.bind(this)}]};Paint.prototype.zoom=function(c){this.public.relativeZoom(c);this.local.relativeZoom(c);this.effectsCanvasCtx.clearRect(0,0,this.effectsCanvas.width,this.effectsCanvas.height)};
Paint.prototype.getCoords=function(c){var a="number"===typeof c.clientX?c.clientX:c.changedTouches[0].clientX,b="number"===typeof c.clientY?c.clientY:c.changedTouches[0].clientY;c=(c.target||document.elementFromPoint(a,b)).getBoundingClientRect();return[a-c.left,b-c.top]};
Paint.prototype.getColorAt=function(c){for(var a=0;a<this.canvasArray.length;a++)this.tempPixelCtx.drawImage(this.canvasArray[a],c[0],c[1],1,1,0,0,1,1);c=this.tempPixelCtx.getImageData(0,0,1,1).data;return this.rgbToHex(c[0],c[1],c[2])};Paint.prototype.rgbToHex=function(c,a,b){return"#"+("000000"+(c<<16|a<<8|b).toString(16)).slice(-6)};Paint.prototype.tempPixelCtx=document.createElement("canvas").getContext("2d");
Paint.prototype.tools={grab:function(c,a){if("remove"==a||"mouseup"==a.type||"touchend"==a.type||"mouseleave"===a.type)delete c.lastGrabCoords,c.effectsCanvas.style.cursor="";else{var b=c.getCoords(a);if(c.lastGrabCoords){var e=c.lastGrabCoords[0]-b[0],d=c.lastGrabCoords[1]-b[1];c.local.goto(c.local.leftTopX+e/c.local.zoom,c.local.leftTopY+d/c.local.zoom);c.public.goto(c.public.leftTopX+e/c.public.zoom,c.public.leftTopY+d/c.public.zoom);for(e=0;e<c.canvasArray.length;e++)c.canvasArray[e].leftTopX=
c.public.leftTopX,c.canvasArray[e].leftTopY=c.public.leftTopY;c.lastGrabCoords=b}else"mousemove"!=a.type&&(c.lastGrabCoords=b,c.effectsCanvas.style.cursor="move")}},line:function(c,a){if("remove"==a)delete c.lastLinePoint,c.effectsCanvas.style.cursor="";else{var b=c.getCoords(a);"mousedown"!=a.type&&"touchstart"!=a.type||c.lastLinePoint||(c.lastLinePoint=b);if("mouseup"==a.type||"touchend"==a.type){if(c.lastLinePoint[0]==b[0]&&c.lastLinePoint[1]==b[1])return;c.addUserDrawing({type:"line",x:Math.round(c.local.leftTopX+
c.lastLinePoint[0]/c.local.zoom),y:Math.round(c.local.leftTopY+c.lastLinePoint[1]/c.local.zoom),x1:Math.round(c.local.leftTopX+b[0]/c.local.zoom),y1:Math.round(c.local.leftTopY+b[1]/c.local.zoom),size:2*c.current_size,color:c.current_color});delete c.lastLinePoint;c.effectsCanvasCtx.clearRect(0,0,c.effectsCanvas.width,c.effectsCanvas.height)}if(("mousemove"==a.type||"touchmove"==a.type)&&c.lastLinePoint){c.effectsCanvasCtx.clearRect(0,0,c.effectsCanvas.width,c.effectsCanvas.height);var e=c.effectsCanvasCtx;
e.beginPath();e.arc(c.lastLinePoint[0],c.lastLinePoint[1],c.current_size*c.local.zoom,0,2*Math.PI,!0);e.fillStyle=c.current_color;e.fill();e.beginPath();e.moveTo(c.lastLinePoint[0],c.lastLinePoint[1]);e.lineTo(b[0],b[1]);e.strokeStyle=c.current_color;e.lineWidth=2*c.current_size*c.local.zoom;e.stroke();e.beginPath();e.arc(b[0],b[1],c.current_size*c.local.zoom,0,2*Math.PI,!0);e.fillStyle=c.current_color;e.fill()}}},brush:function(c,a,b){if("remove"==a)delete c.lastBrushPoint,delete c.lastMovePoint;
else if(this.lastMovePoint=this.lastMovePoint||[0,0],b=c.getCoords(a),"mousedown"!=a.type&&"touchstart"!=a.type||c.lastLinePoint||(c.lastBrushPoint=b,c.addUserDrawing({type:"brush",x:Math.round(c.local.leftTopX+b[0]/c.local.zoom),y:Math.round(c.local.leftTopY+b[1]/c.local.zoom),size:c.current_size,color:c.current_color})),"mouseup"!=a.type&&"touchend"!=a.type||delete c.lastBrushPoint,"mousemove"==a.type||"touchmove"==a.type)c.effectsCanvasCtx.clearRect(this.lastMovePoint[0]-2*c.current_size*c.local.zoom,
this.lastMovePoint[1]-2*c.current_size*c.local.zoom,4*c.current_size*c.local.zoom,4*c.current_size*c.local.zoom),a=c.effectsCanvasCtx,a.beginPath(),a.arc(b[0],b[1],c.current_size*c.local.zoom,0,2*Math.PI,!0),a.fillStyle=c.current_color,a.fill(),this.lastMovePoint[0]=b[0],this.lastMovePoint[1]=b[1],c.lastBrushPoint&&(c.utils.sqDistance(c.lastBrushPoint,b)<c.current_size*c.local.zoom/2*(c.current_size*c.local.zoom/2)?c.addUserDrawing({type:"brush",x:Math.round(c.local.leftTopX+b[0]/c.local.zoom),y:Math.round(c.local.leftTopY+
b[1]/c.local.zoom),size:c.current_size,color:c.current_color}):c.addUserDrawing({type:"line",x:Math.round(c.local.leftTopX+c.lastBrushPoint[0]/c.local.zoom),y:Math.round(c.local.leftTopY+c.lastBrushPoint[1]/c.local.zoom),x1:Math.round(c.local.leftTopX+b[0]/c.local.zoom),y1:Math.round(c.local.leftTopY+b[1]/c.local.zoom),size:2*c.current_size,color:c.current_color}),c.lastBrushPoint=b)},picker:function(c,a){if("remove"==a)delete c.picking,c.effectsCanvas.style.cursor="";else{var b=c.getCoords(a);"mousedown"!=
a.type&&"touchstart"!=a.type||c.picking||(c.picking=!0,c.setColor(c.getColorAt(b)),c.effectsCanvas.style.cursor="crosshair");if("mouseup"==a.type||"touchend"==a.type)delete c.picking,c.effectsCanvas.style.cursor="";("mousemove"==a.type||"touchmove"==a.type)&&c.picking&&c.setColor(c.getColorAt(b))}},block:function(c,a){this.brush(c,a,"block")}};
Paint.prototype.drawFunctions={brush:function(c,a,b){c.beginPath();c.arc(a.x,a.y,a.size,0,2*Math.PI,!0);c.fillStyle=a.color;c.fill();b&&(b.drawingRegion(a.x,a.y,a.x,a.y,a.size),b.executeNoRedraw())},block:function(c,a,b){c.fillStyle=a.color;c.fillRect(a.x,a.y,a.size,a.size);b&&(b.drawingRegion(a.x,a.y,a.x,a.y,a.size),b.executeNoRedraw())},line:function(c,a,b){this.brush(c,{x:a.x,y:a.y,color:a.color,size:a.size/2},b);c.beginPath();c.moveTo(a.x,a.y);c.lineTo(a.x1,a.y1);c.strokeStyle=a.color;c.lineWidth=
a.size;c.stroke();b&&(b.drawingRegion(a.x,a.y,a.x1,a.y1,a.size),b.executeNoRedraw());this.brush(c,{x:a.x1,y:a.y1,color:a.color,size:a.size/2},b)}};Paint.prototype.utils={copy:function(c){var a={},b;for(b in c)a[b]="object"==typeof c[b]?this.copy(c[b]):c[b];return a},merge:function(c,a){"object"!=typeof c&&(c={});for(var b in a)"object"==typeof a[b]?c[b]=this.merge(c[b],a[b]):"undefined"==typeof c[b]&&(c[b]=a[b]);return c},sqDistance:function(c,a){var b=c[0]-a[0],e=c[1]-a[1];return b*b+e*e}};
var EventDispatcher=function(){};
EventDispatcher.prototype={constructor:EventDispatcher,apply:function(c){c.addEventListener=EventDispatcher.prototype.addEventListener;c.hasEventListener=EventDispatcher.prototype.hasEventListener;c.removeEventListener=EventDispatcher.prototype.removeEventListener;c.dispatchEvent=EventDispatcher.prototype.dispatchEvent},addEventListener:function(c,a){void 0===this._listeners&&(this._listeners={});var b=this._listeners;void 0===b[c]&&(b[c]=[]);-1===b[c].indexOf(a)&&b[c].push(a)},hasEventListener:function(c,
a){if(void 0===this._listeners)return!1;var b=this._listeners;return void 0!==b[c]&&-1!==b[c].indexOf(a)?!0:!1},removeEventListener:function(c,a){if(void 0!==this._listeners){var b=this._listeners[c];if(void 0!==b){var e=b.indexOf(a);-1!==e&&b.splice(e,1)}}},dispatchEvent:function(c){if(void 0!==this._listeners){var a=this._listeners[c.type];if(void 0!==a){c.target=this;for(var b=[],e=a.length,d=0;d<e;d++)b[d]=a[d];for(d=0;d<e;d++)b[d].call(this,c)}}}};EventDispatcher.prototype.apply(Paint.prototype);function TiledCanvas(c,a){this.canvas=c;this.ctx=this.canvas.getContext("2d");this.leftTopY=this.leftTopX=0;this.zoom=1;this.affecting=[[0,0],[0,0]];this.chunks={};this.settings=this.normalizeDefaults(a,this.defaultSettings);this.contextQueue=[];this.context=this.createContext()}TiledCanvas.prototype.defaultSettings={chunkSize:256};TiledCanvas.prototype.cloneObject=function(c){var a={},b;for(b in c)a[b]="object"!==typeof c[b]||c[b]instanceof Array?c[b]:this.cloneObject(c[b]);return a};
TiledCanvas.prototype.normalizeDefaults=function(c,a){c=c||{};var b=this.cloneObject(c),e;for(e in a)b[e]="object"!==typeof a[e]||a[e]instanceof Array?c[e]||a[e]:this.normalizeDefaults(c[e]||{},a[e]);return b};
TiledCanvas.prototype.redraw=function(c){c||this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);var a=Math.floor(this.leftTopX/this.settings.chunkSize);c=Math.ceil((this.leftTopX+this.canvas.width/this.zoom)/this.settings.chunkSize);for(var b=Math.floor(this.leftTopY/this.settings.chunkSize),e=Math.ceil((this.leftTopY+this.canvas.height/this.zoom)/this.settings.chunkSize);a<c;a++)for(var d=b;d<e;d++)this.drawChunk(a,d)};
TiledCanvas.prototype.drawChunk=function(c,a){this.chunks[c]&&this.chunks[c][a]&&"empty"!==this.chunks[c][a]?this.ctx.drawImage(this.chunks[c][a].canvas,(c*this.settings.chunkSize-this.leftTopX)*this.zoom,(a*this.settings.chunkSize-this.leftTopY)*this.zoom,this.settings.chunkSize*this.zoom,this.settings.chunkSize*this.zoom):"function"!=typeof this.requestUserChunk||this.chunks[c]&&"empty"===this.chunks[c][a]||this.requestChunk(c,a)};
TiledCanvas.prototype.goto=function(c,a){this.leftTopX=c;this.leftTopY=a;this.redraw()};TiledCanvas.prototype.relativeZoom=function(c){this.zoom*=c;this.redraw()};TiledCanvas.prototype.absoluteZoom=function(c){this.zoom=c;this.redraw()};TiledCanvas.prototype.execute=function(){this.executeNoRedraw();this.redraw()};
TiledCanvas.prototype.executeNoRedraw=function(){for(var c=this.affecting[0][0];c<this.affecting[1][0];c++)for(var a=this.affecting[0][1];a<this.affecting[1][1];a++)this.executeChunk(c,a);this.contextQueue=[]};TiledCanvas.prototype.clearAll=function(){this.contextQueue=[];for(var c in this.chunks)this.clearChunkRow(c)};TiledCanvas.prototype.clearChunkRow=function(c){for(var a in this.chunks[c])this.clearChunk(c,a)};
TiledCanvas.prototype.clearChunk=function(c,a){"empty"!=this.chunks[c][a]&&this.chunks[c][a].clearRect(c*this.settings.chunkSize,a*this.settings.chunkSize,this.chunks[c][a].canvas.width,this.chunks[c][a].canvas.height)};
TiledCanvas.prototype.requestChunk=function(c,a,b){"function"===typeof this.requestUserChunk&&(this.requestChunkCallbackList=this.requestChunkCallbackList||{},this.requestChunkCallbackList[c]&&this.requestChunkCallbackList[c][a]?b&&this.requestChunkCallbackList[c][a].push(b):(this.requestChunkCallbackList[c]=this.requestChunkCallbackList[c]||{},this.requestChunkCallbackList[c][a]=b?[b]:[],this.requestUserChunk(c,a,function(b){setTimeout(this.setUserChunk.bind(this,c,a,b))}.bind(this))))};
TiledCanvas.prototype.setUserChunk=function(c,a,b){if(!this.chunks[c]||!this.chunks[c][a])if(b||this.requestChunkCallbackList[c]&&0!=this.requestChunkCallbackList[c][a].lenth){this.chunks[c]=this.chunks[c]||{};this.chunks[c][a]=this.newCtx(this.settings.chunkSize,this.settings.chunkSize,-c*this.settings.chunkSize,-a*this.settings.chunkSize);b&&this.chunks[c][a].drawImage(b,c*this.settings.chunkSize,a*this.settings.chunkSize);b=this.requestChunkCallbackList[c][a];for(var e=0;e<b.length;e++)b[e]();
this.redraw();delete this.requestChunkCallbackList[c][a]}else this.chunks[c]=this.chunks[c]||{},this.chunks[c][a]="empty"};TiledCanvas.prototype.copyArray=function(c){for(var a=[],b=0;b<c.length;b++)a[b]=c[b];return a};
TiledCanvas.prototype.executeChunk=function(c,a,b){this.chunks[c]=this.chunks[c]||[];if(!this.chunks[c][a]||"empty"==this.chunks[c][a]){if("function"==typeof this.requestUserChunk&&"empty"!==this.chunks[c][a]){this.requestChunk(c,a,function(b){this.executeChunk(c,a,b)}.bind(this,this.copyArray(b||this.contextQueue)));return}this.chunks[c][a]=this.newCtx(this.settings.chunkSize,this.settings.chunkSize,-c*this.settings.chunkSize,-a*this.settings.chunkSize)}var e=this.chunks[c][a];b=b||this.contextQueue;
for(var d=0;d<b.length;d++)"function"===typeof e[b[d][0]]?this.executeQueueOnChunk(e,b[d]):e[b[d][0]]=b[d][1]};TiledCanvas.prototype.executeQueueOnChunk=function(c,a){c[a[0]].apply(c,Array.prototype.slice.call(a,1))};
TiledCanvas.prototype.drawingRegion=function(c,a,b,e,d){d=d||0;this.affecting[0][0]=Math.floor((Math.min(c,b)-d)/this.settings.chunkSize);this.affecting[0][1]=Math.floor((Math.min(a,e)-d)/this.settings.chunkSize);this.affecting[1][0]=Math.ceil((Math.max(b,c)+d)/this.settings.chunkSize);this.affecting[1][1]=Math.ceil((Math.max(e,a)+d)/this.settings.chunkSize)};
TiledCanvas.prototype.newCtx=function(c,a,b,e){var d=document.createElement("canvas").getContext("2d");d.canvas.width=c;d.canvas.height=a;d.translate(b,e);return d};
TiledCanvas.prototype.createContext=function(){var c={},a=document.createElement("canvas").getContext("2d"),b;for(b in a)"function"===typeof a[b]?c[b]=function(c){this.contextQueue.push(arguments)}.bind(this,b):"object"!==typeof a[b]&&(c.__defineGetter__(b,function(c){for(var a=this.newCtx(),b=0;b<this.contextQueue.length;b++)"function"===typeof a[args[0]]?a[args[0]].apply(a,args.slice(1)):a[args[0]]=args[1];return a[c]}.bind(this,b)),c.__defineSetter__(b,function(c,a){this.contextQueue.push(arguments)}.bind(this,
b)));return c};var CryptoJS=CryptoJS||function(c,a){var b={},e=b.lib={},d=function(){},f=e.Base={extend:function(c){d.prototype=this;var a=new d;c&&a.mixIn(c);a.hasOwnProperty("init")||(a.init=function(){a.$super.init.apply(this,arguments)});a.init.prototype=a;a.$super=this;return a},create:function(){var c=this.extend();c.init.apply(c,arguments);return c},init:function(){},mixIn:function(c){for(var a in c)c.hasOwnProperty(a)&&(this[a]=c[a]);c.hasOwnProperty("toString")&&(this.toString=c.toString)},clone:function(){return this.init.prototype.extend(this)}},
l=e.WordArray=f.extend({init:function(c,b){c=this.words=c||[];this.sigBytes=b!=a?b:4*c.length},toString:function(c){return(c||h).stringify(this)},concat:function(c){var a=this.words,b=c.words,d=this.sigBytes;c=c.sigBytes;this.clamp();if(d%4)for(var f=0;f<c;f++)a[d+f>>>2]|=(b[f>>>2]>>>24-8*(f%4)&255)<<24-8*((d+f)%4);else if(65535<b.length)for(f=0;f<c;f+=4)a[d+f>>>2]=b[f>>>2];else a.push.apply(a,b);this.sigBytes+=c;return this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<
32-8*(b%4);a.length=c.ceil(b/4)},clone:function(){var c=f.clone.call(this);c.words=this.words.slice(0);return c},random:function(a){for(var b=[],d=0;d<a;d+=4)b.push(4294967296*c.random()|0);return new l.init(b,a)}}),g=b.enc={},h=g.Hex={stringify:function(c){var a=c.words;c=c.sigBytes;for(var b=[],d=0;d<c;d++){var f=a[d>>>2]>>>24-8*(d%4)&255;b.push((f>>>4).toString(16));b.push((f&15).toString(16))}return b.join("")},parse:function(c){for(var a=c.length,b=[],d=0;d<a;d+=2)b[d>>>3]|=parseInt(c.substr(d,
2),16)<<24-4*(d%8);return new l.init(b,a/2)}},m=g.Latin1={stringify:function(c){var a=c.words;c=c.sigBytes;for(var b=[],d=0;d<c;d++)b.push(String.fromCharCode(a[d>>>2]>>>24-8*(d%4)&255));return b.join("")},parse:function(c){for(var a=c.length,b=[],d=0;d<a;d++)b[d>>>2]|=(c.charCodeAt(d)&255)<<24-8*(d%4);return new l.init(b,a)}},q=g.Utf8={stringify:function(c){try{return decodeURIComponent(escape(m.stringify(c)))}catch(a){throw Error("Malformed UTF-8 data");}},parse:function(c){return m.parse(unescape(encodeURIComponent(c)))}},
n=e.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new l.init;this._nDataBytes=0},_append:function(c){"string"==typeof c&&(c=q.parse(c));this._data.concat(c);this._nDataBytes+=c.sigBytes},_process:function(a){var b=this._data,d=b.words,f=b.sigBytes,e=this.blockSize,g=f/(4*e),g=a?c.ceil(g):c.max((g|0)-this._minBufferSize,0);a=g*e;f=c.min(4*a,f);if(a){for(var n=0;n<a;n+=e)this._doProcessBlock(d,n);n=d.splice(0,a);b.sigBytes-=f}return new l.init(n,f)},clone:function(){var c=f.clone.call(this);
c._data=this._data.clone();return c},_minBufferSize:0});e.Hasher=n.extend({cfg:f.extend(),init:function(c){this.cfg=this.cfg.extend(c);this.reset()},reset:function(){n.reset.call(this);this._doReset()},update:function(c){this._append(c);this._process();return this},finalize:function(c){c&&this._append(c);return this._doFinalize()},blockSize:16,_createHelper:function(c){return function(a,b){return(new c.init(b)).finalize(a)}},_createHmacHelper:function(c){return function(a,b){return(new u.HMAC.init(c,
b)).finalize(a)}}});var u=b.algo={};return b}(Math);
(function(c){for(var a=CryptoJS,b=a.lib,e=b.WordArray,d=b.Hasher,b=a.algo,f=[],l=[],g=function(c){return 4294967296*(c-(c|0))|0},h=2,m=0;64>m;){var q;a:{q=h;for(var n=c.sqrt(q),u=2;u<=n;u++)if(!(q%u)){q=!1;break a}q=!0}q&&(8>m&&(f[m]=g(c.pow(h,0.5))),l[m]=g(c.pow(h,1/3)),m++);h++}var s=[],b=b.SHA256=d.extend({_doReset:function(){this._hash=new e.init(f.slice(0))},_doProcessBlock:function(c,a){for(var b=this._hash.words,d=b[0],f=b[1],e=b[2],g=b[3],n=b[4],h=b[5],q=b[6],u=b[7],m=0;64>m;m++){if(16>m)s[m]=
c[a+m]|0;else{var K=s[m-15],z=s[m-2];s[m]=((K<<25|K>>>7)^(K<<14|K>>>18)^K>>>3)+s[m-7]+((z<<15|z>>>17)^(z<<13|z>>>19)^z>>>10)+s[m-16]}K=u+((n<<26|n>>>6)^(n<<21|n>>>11)^(n<<7|n>>>25))+(n&h^~n&q)+l[m]+s[m];z=((d<<30|d>>>2)^(d<<19|d>>>13)^(d<<10|d>>>22))+(d&f^d&e^f&e);u=q;q=h;h=n;n=g+K|0;g=e;e=f;f=d;d=K+z|0}b[0]=b[0]+d|0;b[1]=b[1]+f|0;b[2]=b[2]+e|0;b[3]=b[3]+g|0;b[4]=b[4]+n|0;b[5]=b[5]+h|0;b[6]=b[6]+q|0;b[7]=b[7]+u|0},_doFinalize:function(){var a=this._data,b=a.words,d=8*this._nDataBytes,f=8*a.sigBytes;
b[f>>>5]|=128<<24-f%32;b[(f+64>>>9<<4)+14]=c.floor(d/4294967296);b[(f+64>>>9<<4)+15]=d;a.sigBytes=4*b.length;this._process();return this._hash},clone:function(){var c=d.clone.call(this);c._hash=this._hash.clone();return c}});a.SHA256=d._createHelper(b);a.HmacSHA256=d._createHmacHelper(b)})(Math);!function(c){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=c();else if("function"==typeof define&&define.amd)define([],c);else{var a;"undefined"!=typeof window?a=window:"undefined"!=typeof global?a=global:"undefined"!=typeof self&&(a=self);a.io=c()}}(function(){return function a(b,e,d){function f(g,m){if(!e[g]){if(!b[g]){var q="function"==typeof require&&require;if(!m&&q)return q(g,!0);if(l)return l(g,!0);throw Error("Cannot find module '"+g+"'");}q=e[g]={exports:{}};b[g][0].call(q.exports,
function(a){var d=b[g][1][a];return f(d?d:a)},q,q.exports,a,b,e,d)}return e[g].exports}for(var l="function"==typeof require&&require,g=0;g<d.length;g++)f(d[g]);return f}({1:[function(a,b,e){b.exports=a("./lib/")},{"./lib/":2}],2:[function(a,b,e){function d(a,b){"object"==typeof a&&(b=a,a=void 0);b=b||{};var d=f(a),e=d.source,k=d.id;b.forceNew||b["force new connection"]||!1===b.multiplex?(h("ignoring socket cache for %s",e),e=g(e,b)):(m[k]||(h("new io instance for %s",e),m[k]=g(e,b)),e=m[k]);return e.socket(d.path)}
var f=a("./url"),l=a("socket.io-parser"),g=a("./manager"),h=a("debug")("socket.io-client");b.exports=e=d;var m=e.managers={};e.protocol=l.protocol;e.connect=d;e.Manager=a("./manager");e.Socket=a("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:9,"socket.io-parser":40}],3:[function(a,b,e){function d(a,b){if(!(this instanceof d))return new d(a,b);a&&"object"==typeof a&&(b=a,a=void 0);b=b||{};b.path=b.path||"/socket.io";this.nsps={};this.subs=[];this.opts=b;this.reconnection(!1!==b.reconnection);
this.reconnectionAttempts(b.reconnectionAttempts||Infinity);this.reconnectionDelay(b.reconnectionDelay||1E3);this.reconnectionDelayMax(b.reconnectionDelayMax||5E3);this.timeout(null==b.timeout?2E4:b.timeout);this.readyState="closed";this.uri=a;this.attempts=this.connected=0;this.encoding=!1;this.packetBuffer=[];this.encoder=new g.Encoder;this.decoder=new g.Decoder;(this.autoConnect=!1!==b.autoConnect)&&this.open()}a("./url");var f=a("engine.io-client"),l=a("./socket");e=a("component-emitter");var g=
a("socket.io-parser"),h=a("./on"),m=a("component-bind");a("object-component");var q=a("debug")("socket.io-client:manager");b.exports=d;d.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var a in this.nsps)this.nsps[a].emit.apply(this.nsps[a],arguments)};e(d.prototype);d.prototype.reconnection=function(a){if(!arguments.length)return this._reconnection;this._reconnection=!!a;return this};d.prototype.reconnectionAttempts=function(a){if(!arguments.length)return this._reconnectionAttempts;
this._reconnectionAttempts=a;return this};d.prototype.reconnectionDelay=function(a){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=a;return this};d.prototype.reconnectionDelayMax=function(a){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=a;return this};d.prototype.timeout=function(a){if(!arguments.length)return this._timeout;this._timeout=a;return this};d.prototype.maybeReconnectOnOpen=function(){this.openReconnect||(this.reconnecting||
!this._reconnection||0!==this.attempts)||(this.openReconnect=!0,this.reconnect())};d.prototype.open=d.prototype.connect=function(a){q("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;q("opening %s",this.uri);var b=this.engine=f(this.uri,this.opts),d=this;this.readyState="opening";var k=h(b,"open",function(){d.onopen();a&&a()}),e=h(b,"error",function(b){q("connect_error");d.cleanup();d.readyState="closed";d.emitAll("connect_error",b);if(a){var f=Error("Connection error");
f.data=b;a(f)}d.maybeReconnectOnOpen()});if(!1!==this._timeout){var l=this._timeout;q("connect attempt will timeout after %d",l);var g=setTimeout(function(){q("connect attempt timed out after %d",l);k.destroy();b.close();b.emit("error","timeout");d.emitAll("connect_timeout",l)},l);this.subs.push({destroy:function(){clearTimeout(g)}})}this.subs.push(k);this.subs.push(e);return this};d.prototype.onopen=function(){q("open");this.cleanup();this.readyState="open";this.emit("open");var a=this.engine;this.subs.push(h(a,
"data",m(this,"ondata")));this.subs.push(h(this.decoder,"decoded",m(this,"ondecoded")));this.subs.push(h(a,"error",m(this,"onerror")));this.subs.push(h(a,"close",m(this,"onclose")))};d.prototype.ondata=function(a){this.decoder.add(a)};d.prototype.ondecoded=function(a){this.emit("packet",a)};d.prototype.onerror=function(a){q("error",a);this.emitAll("error",a)};d.prototype.socket=function(a){var b=this.nsps[a];if(!b){b=new l(this,a);this.nsps[a]=b;var d=this;b.on("connect",function(){d.connected++})}return b};
d.prototype.destroy=function(a){--this.connected||this.close()};d.prototype.packet=function(a){q("writing packet %j",a);var b=this;b.encoding?b.packetBuffer.push(a):(b.encoding=!0,this.encoder.encode(a,function(a){for(var d=0;d<a.length;d++)b.engine.write(a[d]);b.encoding=!1;b.processPacketQueue()}))};d.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var a=this.packetBuffer.shift();this.packet(a)}};d.prototype.cleanup=function(){for(var a;a=this.subs.shift();)a.destroy();
this.packetBuffer=[];this.encoding=!1;this.decoder.destroy()};d.prototype.close=d.prototype.disconnect=function(){this.skipReconnect=!0;this.engine.close()};d.prototype.onclose=function(a){q("close");this.cleanup();this.readyState="closed";this.emit("close",a);this._reconnection&&!this.skipReconnect&&this.reconnect()};d.prototype.reconnect=function(){if(this.reconnecting)return this;var a=this;this.attempts++;if(this.attempts>this._reconnectionAttempts)q("reconnect failed"),this.emitAll("reconnect_failed"),
this.reconnecting=!1;else{var b=this.attempts*this.reconnectionDelay(),b=Math.min(b,this.reconnectionDelayMax());q("will wait %dms before reconnect attempt",b);this.reconnecting=!0;var d=setTimeout(function(){q("attempting reconnect");a.emitAll("reconnect_attempt",a.attempts);a.emitAll("reconnecting",a.attempts);a.open(function(b){b?(q("reconnect attempt error"),a.reconnecting=!1,a.reconnect(),a.emitAll("reconnect_error",b.data)):(q("reconnect success"),a.onreconnect())})},b);this.subs.push({destroy:function(){clearTimeout(d)}})}};
d.prototype.onreconnect=function(){var a=this.attempts;this.attempts=0;this.reconnecting=!1;this.emitAll("reconnect",a)}},{"./on":4,"./socket":5,"./url":6,"component-bind":7,"component-emitter":8,debug:9,"engine.io-client":10,"object-component":37,"socket.io-parser":40}],4:[function(a,b,e){b.exports=function(a,b,e){a.on(b,e);return{destroy:function(){a.removeListener(b,e)}}}},{}],5:[function(a,b,e){function d(a,b){this.io=a;this.nsp=b;this.json=this;this.ids=0;this.acks={};this.io.autoConnect&&this.open();
this.receiveBuffer=[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0;this.subEvents()}var f=a("socket.io-parser");e=a("component-emitter");var l=a("to-array"),g=a("./on"),h=a("component-bind"),m=a("debug")("socket.io-client:socket"),q=a("has-binary");a("indexof");b.exports=d;var n={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},u=e.prototype.emit;e(d.prototype);d.prototype.subEvents=function(){var a=
this.io;this.subs=[g(a,"open",h(this,"onopen")),g(a,"packet",h(this,"onpacket")),g(a,"close",h(this,"onclose"))]};d.prototype.open=d.prototype.connect=function(){if(this.connected)return this;this.io.open();if("open"==this.io.readyState)this.onopen();return this};d.prototype.send=function(){var a=l(arguments);a.unshift("message");this.emit.apply(this,a);return this};d.prototype.emit=function(a){if(n.hasOwnProperty(a))return u.apply(this,arguments),this;var b=l(arguments),d=f.EVENT;q(b)&&(d=f.BINARY_EVENT);
d={type:d,data:b};"function"==typeof b[b.length-1]&&(m("emitting packet with ack id %d",this.ids),this.acks[this.ids]=b.pop(),d.id=this.ids++);this.connected?this.packet(d):this.sendBuffer.push(d);return this};d.prototype.packet=function(a){a.nsp=this.nsp;this.io.packet(a)};d.prototype.onopen=function(){m("transport is open - connecting");"/"!=this.nsp&&this.packet({type:f.CONNECT})};d.prototype.onclose=function(a){m("close (%s)",a);this.connected=!1;this.disconnected=!0;this.emit("disconnect",a)};
d.prototype.onpacket=function(a){if(a.nsp==this.nsp)switch(a.type){case f.CONNECT:this.onconnect();break;case f.EVENT:this.onevent(a);break;case f.BINARY_EVENT:this.onevent(a);break;case f.ACK:this.onack(a);break;case f.BINARY_ACK:this.onack(a);break;case f.DISCONNECT:this.ondisconnect();break;case f.ERROR:this.emit("error",a.data)}};d.prototype.onevent=function(a){var b=a.data||[];m("emitting event %j",b);null!=a.id&&(m("attaching ack callback to event"),b.push(this.ack(a.id)));this.connected?u.apply(this,
b):this.receiveBuffer.push(b)};d.prototype.ack=function(a){var b=this,d=!1;return function(){if(!d){d=!0;var e=l(arguments);m("sending ack %j",e);var g=q(e)?f.BINARY_ACK:f.ACK;b.packet({type:g,id:a,data:e})}}};d.prototype.onack=function(a){m("calling ack %s with %j",a.id,a.data);this.acks[a.id].apply(this,a.data);delete this.acks[a.id]};d.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};d.prototype.emitBuffered=function(){var a;for(a=
0;a<this.receiveBuffer.length;a++)u.apply(this,this.receiveBuffer[a]);this.receiveBuffer=[];for(a=0;a<this.sendBuffer.length;a++)this.packet(this.sendBuffer[a]);this.sendBuffer=[]};d.prototype.ondisconnect=function(){m("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};d.prototype.destroy=function(){for(var a=0;a<this.subs.length;a++)this.subs[a].destroy();this.io.destroy(this)};d.prototype.close=d.prototype.disconnect=function(){if(!this.connected)return this;
m("performing disconnect (%s)",this.nsp);this.packet({type:f.DISCONNECT});this.destroy();this.onclose("io client disconnect");return this}},{"./on":4,"component-bind":7,"component-emitter":8,debug:9,"has-binary":32,indexof:36,"socket.io-parser":40,"to-array":44}],6:[function(a,b,e){(function(d){var f=a("parseuri"),e=a("debug")("socket.io-client:url");b.exports=function(a,b){var m=a;b=b||d.location;null==a&&(a=b.protocol+"//"+b.hostname);"string"==typeof a&&("/"==a.charAt(0)&&"undefined"!=typeof b&&
(a=b.hostname+a),/^(https?|wss?):\/\//.test(a)||(e("protocol-less url %s",a),a="undefined"!=typeof b?b.protocol+"//"+a:"https://"+a),e("parse %s",a),m=f(a));m.port||(/^(http|ws)$/.test(m.protocol)?m.port="80":/^(http|ws)s$/.test(m.protocol)&&(m.port="443"));m.path=m.path||"/";m.id=m.protocol+"://"+m.host+":"+m.port;m.href=m.protocol+"://"+m.host+(b&&b.port==m.port?"":":"+m.port);return m}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{debug:9,parseuri:38}],7:[function(a,
b,e){var d=[].slice;b.exports=function(a,b){"string"==typeof b&&(b=a[b]);if("function"!=typeof b)throw Error("bind() requires a function");var e=d.call(arguments,2);return function(){return b.apply(a,e.concat(d.call(arguments)))}}},{}],8:[function(a,b,e){function d(a){if(a){for(var b in d.prototype)a[b]=d.prototype[b];return a}}b.exports=d;d.prototype.on=d.prototype.addEventListener=function(a,b){this._callbacks=this._callbacks||{};(this._callbacks[a]=this._callbacks[a]||[]).push(b);return this};
d.prototype.once=function(a,b){function d(){e.off(a,d);b.apply(this,arguments)}var e=this;this._callbacks=this._callbacks||{};d.fn=b;this.on(a,d);return this};d.prototype.off=d.prototype.removeListener=d.prototype.removeAllListeners=d.prototype.removeEventListener=function(a,b){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var d=this._callbacks[a];if(!d)return this;if(1==arguments.length)return delete this._callbacks[a],this;for(var e,m=0;m<d.length;m++)if(e=
d[m],e===b||e.fn===b){d.splice(m,1);break}return this};d.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),d=this._callbacks[a];if(d)for(var d=d.slice(0),e=0,m=d.length;e<m;++e)d[e].apply(this,b);return this};d.prototype.listeners=function(a){this._callbacks=this._callbacks||{};return this._callbacks[a]||[]};d.prototype.hasListeners=function(a){return!!this.listeners(a).length}},{}],9:[function(a,b,e){function d(a){return d.enabled(a)?function(b){b instanceof
Error&&(b=b.stack||b.message);var f=new Date,e=f-(d[a]||f);d[a]=f;b=a+" "+b+" +"+d.humanize(e);window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}b.exports=d;d.names=[];d.skips=[];d.enable=function(a){try{localStorage.debug=a}catch(b){}for(var f=(a||"").split(/[\s,]+/),e=f.length,q=0;q<e;q++)a=f[q].replace("*",".*?"),"-"===a[0]?d.skips.push(RegExp("^"+a.substr(1)+"$")):d.names.push(RegExp("^"+a+"$"))};d.disable=function(){d.enable("")};d.humanize=
function(a){return 36E5<=a?(a/36E5).toFixed(1)+"h":6E4<=a?(a/6E4).toFixed(1)+"m":1E3<=a?(a/1E3|0)+"s":a+"ms"};d.enabled=function(a){for(var b=0,f=d.skips.length;b<f;b++)if(d.skips[b].test(a))return!1;b=0;for(f=d.names.length;b<f;b++)if(d.names[b].test(a))return!0;return!1};try{window.localStorage&&d.enable(localStorage.debug)}catch(f){}},{}],10:[function(a,b,e){b.exports=a("./lib/")},{"./lib/":11}],11:[function(a,b,e){b.exports=a("./socket");b.exports.parser=a("engine.io-parser")},{"./socket":12,
"engine.io-parser":21}],12:[function(a,b,e){(function(d){function f(a,b){if(!(this instanceof f))return new f(a,b);b=b||{};a&&"object"==typeof a&&(b=a,a=null);a&&(a=n(a),b.host=a.host,b.secure="https"==a.protocol||"wss"==a.protocol,b.port=a.port,a.query&&(b.query=a.query));this.secure=null!=b.secure?b.secure:d.location&&"https:"==location.protocol;if(b.host){var e=b.host.split(":");b.hostname=e.shift();e.length&&(b.port=e.pop())}this.agent=b.agent||!1;this.hostname=b.hostname||(d.location?location.hostname:
"localhost");this.port=b.port||(d.location&&location.port?location.port:this.secure?443:80);this.query=b.query||{};"string"==typeof this.query&&(this.query=s.decode(this.query));this.upgrade=!1!==b.upgrade;this.path=(b.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!b.forceJSONP;this.jsonp=!1!==b.jsonp;this.forceBase64=!!b.forceBase64;this.enablesXDR=!!b.enablesXDR;this.timestampParam=b.timestampParam||"t";this.timestampRequests=b.timestampRequests;this.transports=b.transports||["polling",
"websocket"];this.readyState="";this.writeBuffer=[];this.callbackBuffer=[];this.policyPort=b.policyPort||843;this.rememberUpgrade=b.rememberUpgrade||!1;this.open();this.binaryType=null;this.onlyBinaryUpgrades=b.onlyBinaryUpgrades}var e=a("./transports"),g=a("component-emitter"),h=a("debug")("engine.io-client:socket"),m=a("indexof"),q=a("engine.io-parser"),n=a("parseuri"),u=a("parsejson"),s=a("parseqs");b.exports=f;f.priorWebsocketSuccess=!1;g(f.prototype);f.protocol=q.protocol;f.Socket=f;f.Transport=
a("./transport");f.transports=a("./transports");f.parser=a("engine.io-parser");f.prototype.createTransport=function(a){h('creating transport "%s"',a);var b=this.query,d={},f;for(f in b)b.hasOwnProperty(f)&&(d[f]=b[f]);d.EIO=q.protocol;d.transport=a;this.id&&(d.sid=this.id);return new e[a]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:d,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,
timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this})};f.prototype.open=function(){var a;if(this.rememberUpgrade&&f.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))a="websocket";else{if(0==this.transports.length){var b=this;setTimeout(function(){b.emit("error","No transports available")},0);return}a=this.transports[0]}this.readyState="opening";try{a=this.createTransport(a)}catch(d){this.transports.shift();this.open();return}a.open();this.setTransport(a)};f.prototype.setTransport=
function(a){h("setting transport %s",a.name);var b=this;this.transport&&(h("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());this.transport=a;a.on("drain",function(){b.onDrain()}).on("packet",function(a){b.onPacket(a)}).on("error",function(a){b.onError(a)}).on("close",function(){b.onClose("transport close")})};f.prototype.probe=function(a){function b(){if(u.onlyBinaryUpgrades){var d=!this.supportsBinary&&u.transport.supportsBinary;m=m||d}m||(h('probe transport "%s" opened',
a),n.send([{type:"ping",data:"probe"}]),n.once("packet",function(b){m||("pong"==b.type&&"probe"==b.data?(h('probe transport "%s" pong',a),u.upgrading=!0,u.emit("upgrading",n),f.priorWebsocketSuccess="websocket"==n.name,h('pausing current transport "%s"',u.transport.name),u.transport.pause(function(){m||("closed"==u.readyState||"closing"==u.readyState)||(h("changing transport and sending upgrade packet"),s(),u.setTransport(n),n.send([{type:"upgrade"}]),u.emit("upgrade",n),n=null,u.upgrading=!1,u.flush())})):
(h('probe transport "%s" failed',a),b=Error("probe error"),b.transport=n.name,u.emit("upgradeError",b)))}))}function d(){m||(m=!0,s(),n.close(),n=null)}function e(b){var f=Error("probe error: "+b);f.transport=n.name;d();h('probe transport "%s" failed because of error: %s',a,b);u.emit("upgradeError",f)}function l(){e("transport closed")}function g(){e("socket closed")}function q(a){n&&a.name!=n.name&&(h('"%s" works - aborting "%s"',a.name,n.name),d())}function s(){n.removeListener("open",b);n.removeListener("error",
e);n.removeListener("close",l);u.removeListener("close",g);u.removeListener("upgrading",q)}h('probing transport "%s"',a);var n=this.createTransport(a,{probe:1}),m=!1,u=this;f.priorWebsocketSuccess=!1;n.once("open",b);n.once("error",e);n.once("close",l);this.once("close",g);this.once("upgrading",q);n.open()};f.prototype.onOpen=function(){h("socket open");this.readyState="open";f.priorWebsocketSuccess="websocket"==this.transport.name;this.emit("open");this.flush();if("open"==this.readyState&&this.upgrade&&
this.transport.pause){h("starting upgrade probes");for(var a=0,b=this.upgrades.length;a<b;a++)this.probe(this.upgrades[a])}};f.prototype.onPacket=function(a){if("opening"==this.readyState||"open"==this.readyState)switch(h('socket receive: type "%s", data "%s"',a.type,a.data),this.emit("packet",a),this.emit("heartbeat"),a.type){case "open":this.onHandshake(u(a.data));break;case "pong":this.setPing();break;case "error":var b=Error("server error");b.code=a.data;this.emit("error",b);break;case "message":this.emit("data",
a.data),this.emit("message",a.data)}else h('packet received with socket readyState "%s"',this.readyState)};f.prototype.onHandshake=function(a){this.emit("handshake",a);this.id=a.sid;this.transport.query.sid=a.sid;this.upgrades=this.filterUpgrades(a.upgrades);this.pingInterval=a.pingInterval;this.pingTimeout=a.pingTimeout;this.onOpen();"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};f.prototype.onHeartbeat=function(a){clearTimeout(this.pingTimeoutTimer);
var b=this;b.pingTimeoutTimer=setTimeout(function(){if("closed"!=b.readyState)b.onClose("ping timeout")},a||b.pingInterval+b.pingTimeout)};f.prototype.setPing=function(){var a=this;clearTimeout(a.pingIntervalTimer);a.pingIntervalTimer=setTimeout(function(){h("writing ping packet - expecting pong within %sms",a.pingTimeout);a.ping();a.onHeartbeat(a.pingTimeout)},a.pingInterval)};f.prototype.ping=function(){this.sendPacket("ping")};f.prototype.onDrain=function(){for(var a=0;a<this.prevBufferLen;a++)if(this.callbackBuffer[a])this.callbackBuffer[a]();
this.writeBuffer.splice(0,this.prevBufferLen);this.callbackBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;0==this.writeBuffer.length?this.emit("drain"):this.flush()};f.prototype.flush=function(){"closed"!=this.readyState&&(this.transport.writable&&!this.upgrading&&this.writeBuffer.length)&&(h("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};f.prototype.write=f.prototype.send=function(a,
b){this.sendPacket("message",a,b);return this};f.prototype.sendPacket=function(a,b,d){a={type:a,data:b};this.emit("packetCreate",a);this.writeBuffer.push(a);this.callbackBuffer.push(d);this.flush()};f.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.onClose("forced close"),h("socket closing - telling transport to close"),this.transport.close();return this};f.prototype.onError=function(a){h("socket error %j",a);f.priorWebsocketSuccess=!1;this.emit("error",a);this.onClose("transport error",
a)};f.prototype.onClose=function(a,b){if("opening"==this.readyState||"open"==this.readyState){h('socket close with reason: "%s"',a);var d=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);setTimeout(function(){d.writeBuffer=[];d.callbackBuffer=[];d.prevBufferLen=0},0);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();this.readyState="closed";this.id=null;this.emit("close",a,b)}};f.prototype.filterUpgrades=function(a){for(var b=
[],d=0,f=a.length;d<f;d++)~m(this.transports,a[d])&&b.push(a[d]);return b}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./transport":13,"./transports":14,"component-emitter":8,debug:9,"engine.io-parser":21,indexof:36,parsejson:28,parseqs:29,parseuri:30}],13:[function(a,b,e){function d(a){this.path=a.path;this.hostname=a.hostname;this.port=a.port;this.secure=a.secure;this.query=a.query;this.timestampParam=a.timestampParam;this.timestampRequests=a.timestampRequests;
this.readyState="";this.agent=a.agent||!1;this.socket=a.socket;this.enablesXDR=a.enablesXDR}var f=a("engine.io-parser");a=a("component-emitter");b.exports=d;a(d.prototype);d.timestamps=0;d.prototype.onError=function(a,b){var d=Error(a);d.type="TransportError";d.description=b;this.emit("error",d);return this};d.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this};d.prototype.close=function(){if("opening"==this.readyState||
"open"==this.readyState)this.doClose(),this.onClose();return this};d.prototype.send=function(a){if("open"==this.readyState)this.write(a);else throw Error("Transport not open");};d.prototype.onOpen=function(){this.readyState="open";this.writable=!0;this.emit("open")};d.prototype.onData=function(a){a=f.decodePacket(a,this.socket.binaryType);this.onPacket(a)};d.prototype.onPacket=function(a){this.emit("packet",a)};d.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},{"component-emitter":8,
"engine.io-parser":21}],14:[function(a,b,e){(function(b){var f=a("xmlhttprequest"),l=a("./polling-xhr"),g=a("./polling-jsonp"),h=a("./websocket");e.polling=function(a){var e=!1,n=!1,h=!1!==a.jsonp;b.location&&(n="https:"==location.protocol,(e=location.port)||(e=n?443:80),e=a.hostname!=location.hostname||e!=a.port,n=a.secure!=n);a.xdomain=e;a.xscheme=n;if("open"in new f(a)&&!a.forceJSONP)return new l(a);if(!h)throw Error("JSONP disabled");return new g(a)};e.websocket=h}).call(this,"undefined"!==typeof self?
self:"undefined"!==typeof window?window:{})},{"./polling-jsonp":15,"./polling-xhr":16,"./websocket":18,xmlhttprequest:19}],15:[function(a,b,e){(function(d){function f(){}function e(a){g.call(this,a);this.query=this.query||{};n||(d.___eio||(d.___eio=[]),n=d.___eio);this.index=n.length;var b=this;n.push(function(a){b.onData(a)});this.query.j=this.index;d.document&&d.addEventListener&&d.addEventListener("beforeunload",function(){b.script&&(b.script.onerror=f)})}var g=a("./polling"),h=a("component-inherit");
b.exports=e;var m=/\n/g,q=/\\n/g,n;h(e,g);e.prototype.supportsBinary=!1;e.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);this.form&&(this.form.parentNode.removeChild(this.form),this.form=null);g.prototype.doClose.call(this)};e.prototype.doPoll=function(){var a=this,b=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);b.async=!0;b.src=this.uri();b.onerror=function(b){a.onError("jsonp poll error",
b)};var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(b,d);this.script=b;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a);document.body.removeChild(a)},100)};e.prototype.doWrite=function(a,b){function d(){e();b()}function e(){if(f.iframe)try{f.form.removeChild(f.iframe)}catch(a){f.onError("jsonp polling iframe removal error",a)}try{h=document.createElement('<iframe src="javascript:0" name="'+
f.iframeId+'">')}catch(b){h=document.createElement("iframe"),h.name=f.iframeId,h.src="javascript:0"}h.id=f.iframeId;f.form.appendChild(h);f.iframe=h}var f=this;if(!this.form){var g=document.createElement("form"),l=document.createElement("textarea"),n=this.iframeId="eio_iframe_"+this.index,h;g.className="socketio";g.style.position="absolute";g.style.top="-1000px";g.style.left="-1000px";g.target=n;g.method="POST";g.setAttribute("accept-charset","utf-8");l.name="d";g.appendChild(l);document.body.appendChild(g);
this.form=g;this.area=l}this.form.action=this.uri();e();a=a.replace(q,"\\\n");this.area.value=a.replace(m,"\\n");try{this.form.submit()}catch(Ta){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==f.iframe.readyState&&d()}:this.iframe.onload=d}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":17,"component-inherit":20}],16:[function(a,b,e){(function(d){function f(){}function e(a){q.call(this,a);if(d.location){var b="https:"==
location.protocol,f=location.port;f||(f=b?443:80);this.xd=a.hostname!=d.location.hostname||f!=a.port;this.xs=a.secure!=b}}function g(a){this.method=a.method||"GET";this.uri=a.uri;this.xd=!!a.xd;this.xs=!!a.xs;this.async=!1!==a.async;this.data=void 0!=a.data?a.data:null;this.agent=a.agent;this.isBinary=a.isBinary;this.supportsBinary=a.supportsBinary;this.enablesXDR=a.enablesXDR;this.create()}function h(){for(var a in g.requests)g.requests.hasOwnProperty(a)&&g.requests[a].abort()}var m=a("xmlhttprequest"),
q=a("./polling"),n=a("component-emitter"),u=a("component-inherit"),s=a("debug")("engine.io-client:polling-xhr");b.exports=e;b.exports.Request=g;u(e,q);e.prototype.supportsBinary=!0;e.prototype.request=function(a){a=a||{};a.uri=this.uri();a.xd=this.xd;a.xs=this.xs;a.agent=this.agent||!1;a.supportsBinary=this.supportsBinary;a.enablesXDR=this.enablesXDR;return new g(a)};e.prototype.doWrite=function(a,b){var d=this.request({method:"POST",data:a,isBinary:"string"!==typeof a&&void 0!==a}),e=this;d.on("success",
b);d.on("error",function(a){e.onError("xhr post error",a)});this.sendXhr=d};e.prototype.doPoll=function(){s("xhr poll");var a=this.request(),b=this;a.on("data",function(a){b.onData(a)});a.on("error",function(a){b.onError("xhr poll error",a)});this.pollXhr=a};n(g.prototype);g.prototype.create=function(){var a=this.xhr=new m({agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR}),b=this;try{s("xhr open %s: %s",this.method,this.uri);a.open(this.method,this.uri,this.async);this.supportsBinary&&
(a.responseType="arraybuffer");if("POST"==this.method)try{this.isBinary?a.setRequestHeader("Content-type","application/octet-stream"):a.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}"withCredentials"in a&&(a.withCredentials=!0);this.hasXDR()?(a.onload=function(){b.onLoad()},a.onerror=function(){b.onError(a.responseText)}):a.onreadystatechange=function(){if(4==a.readyState)if(200==a.status||1223==a.status)b.onLoad();else setTimeout(function(){b.onError(a.status)},0)};s("xhr data %s",
this.data);a.send(this.data)}catch(f){setTimeout(function(){b.onError(f)},0);return}d.document&&(this.index=g.requestsCount++,g.requests[this.index]=this)};g.prototype.onSuccess=function(){this.emit("success");this.cleanup()};g.prototype.onData=function(a){this.emit("data",a);this.onSuccess()};g.prototype.onError=function(a){this.emit("error",a);this.cleanup()};g.prototype.cleanup=function(){if("undefined"!=typeof this.xhr&&null!==this.xhr){this.hasXDR()?this.xhr.onload=this.xhr.onerror=f:this.xhr.onreadystatechange=
f;try{this.xhr.abort()}catch(a){}d.document&&delete g.requests[this.index];this.xhr=null}};g.prototype.onLoad=function(){var a;try{var b;try{b=this.xhr.getResponseHeader("Content-Type")}catch(d){}a="application/octet-stream"===b?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(e){this.onError(e)}if(null!=a)this.onData(a)};g.prototype.hasXDR=function(){return"undefined"!==typeof d.XDomainRequest&&!this.xs&&this.enablesXDR};g.prototype.abort=function(){this.cleanup()};d.document&&
(g.requestsCount=0,g.requests={},d.attachEvent?d.attachEvent("onunload",h):d.addEventListener&&d.addEventListener("beforeunload",h))}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":17,"component-emitter":8,"component-inherit":20,debug:9,xmlhttprequest:19}],17:[function(a,b,e){function d(a){var b=a&&a.forceBase64;if(!m||b)this.supportsBinary=!1;f.call(this,a)}var f=a("../transport"),l=a("parseqs"),g=a("engine.io-parser");e=a("component-inherit");var h=
a("debug")("engine.io-client:polling");b.exports=d;var m=function(){return null!=(new (a("xmlhttprequest"))({agent:this.agent,xdomain:!1})).responseType}();e(d,f);d.prototype.name="polling";d.prototype.doOpen=function(){this.poll()};d.prototype.pause=function(a){function b(){h("paused");d.readyState="paused";a()}var d=this;this.readyState="pausing";if(this.polling||!this.writable){var e=0;this.polling&&(h("we are currently polling - waiting to pause"),e++,this.once("pollComplete",function(){h("pre-pause polling complete");
--e||b()}));this.writable||(h("we are currently writing - waiting to pause"),e++,this.once("drain",function(){h("pre-pause writing complete");--e||b()}))}else b()};d.prototype.poll=function(){h("polling");this.polling=!0;this.doPoll();this.emit("poll")};d.prototype.onData=function(a){var b=this;h("polling got data %s",a);g.decodePayload(a,this.socket.binaryType,function(a,d,e){if("opening"==b.readyState)b.onOpen();if("close"==a.type)return b.onClose(),!1;b.onPacket(a)});"closed"!=this.readyState&&
(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():h('ignoring poll - transport state "%s"',this.readyState))};d.prototype.doClose=function(){function a(){h("writing close packet");b.write([{type:"close"}])}var b=this;"open"==this.readyState?(h("transport open - closing"),a()):(h("transport not open - deferring close"),this.once("open",a))};d.prototype.write=function(a){var b=this;this.writable=!1;var d=function(){b.writable=!0;b.emit("drain")},b=this;g.encodePayload(a,
this.supportsBinary,function(a){b.doWrite(a,d)})};d.prototype.uri=function(){var a=this.query||{},b=this.secure?"https":"http",d="";!1!==this.timestampRequests&&(a[this.timestampParam]=+new Date+"-"+f.timestamps++);this.supportsBinary||a.sid||(a.b64=1);a=l.encode(a);this.port&&("https"==b&&443!=this.port||"http"==b&&80!=this.port)&&(d=":"+this.port);a.length&&(a="?"+a);return b+"://"+this.hostname+d+this.path+a}},{"../transport":13,"component-inherit":20,debug:9,"engine.io-parser":21,parseqs:29,xmlhttprequest:19}],
18:[function(a,b,e){function d(a){a&&a.forceBase64&&(this.supportsBinary=!1);f.call(this,a)}var f=a("../transport"),l=a("engine.io-parser"),g=a("parseqs");e=a("component-inherit");var h=a("debug")("engine.io-client:websocket"),m=a("ws");b.exports=d;e(d,f);d.prototype.name="websocket";d.prototype.supportsBinary=!0;d.prototype.doOpen=function(){if(this.check()){var a=this.uri();this.ws=new m(a,void 0,{agent:this.agent});void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.binaryType="arraybuffer";
this.addEventListeners()}};d.prototype.addEventListeners=function(){var a=this;this.ws.onopen=function(){a.onOpen()};this.ws.onclose=function(){a.onClose()};this.ws.onmessage=function(b){a.onData(b.data)};this.ws.onerror=function(b){a.onError("websocket error",b)}};"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(d.prototype.onData=function(a){var b=this;setTimeout(function(){f.prototype.onData.call(b,a)},0)});d.prototype.write=function(a){var b=this;this.writable=!1;
for(var d=0,e=a.length;d<e;d++)l.encodePacket(a[d],this.supportsBinary,function(a){try{b.ws.send(a)}catch(d){h("websocket closed before onclose event")}});setTimeout(function(){b.writable=!0;b.emit("drain")},0)};d.prototype.onClose=function(){f.prototype.onClose.call(this)};d.prototype.doClose=function(){"undefined"!==typeof this.ws&&this.ws.close()};d.prototype.uri=function(){var a=this.query||{},b=this.secure?"wss":"ws",d="";this.port&&("wss"==b&&443!=this.port||"ws"==b&&80!=this.port)&&(d=":"+
this.port);this.timestampRequests&&(a[this.timestampParam]=+new Date);this.supportsBinary||(a.b64=1);a=g.encode(a);a.length&&(a="?"+a);return b+"://"+this.hostname+d+this.path+a};d.prototype.check=function(){return!!m&&!("__initialize"in m&&this.name===d.prototype.name)}},{"../transport":13,"component-inherit":20,debug:9,"engine.io-parser":21,parseqs:29,ws:31}],19:[function(a,b,e){var d=a("has-cors");b.exports=function(a){var b=a.xdomain,e=a.xscheme;a=a.enablesXDR;try{if("undefined"!=typeof XDomainRequest&&
!e&&a)return new XDomainRequest}catch(h){}try{if("undefined"!=typeof XMLHttpRequest&&(!b||d))return new XMLHttpRequest}catch(m){}if(!b)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(q){}}},{"has-cors":34}],20:[function(a,b,e){b.exports=function(a,b){var e=function(){};e.prototype=b.prototype;a.prototype=new e;a.prototype.constructor=a}},{}],21:[function(a,b,e){(function(b){function f(a,b,d){if(!b)return e.encodeBase64Packet(a,d);var f=new FileReader;f.onload=function(){a.data=f.result;e.encodePacket(a,
b,!0,d)};return f.readAsArrayBuffer(a.data)}function l(a,b,d){var e=Array(a.length);d=q(a.length,d);for(var f=function(a,d,f){b(d,function(b,d){e[a]=d;f(b,e)})},g=0;g<a.length;g++)f(g,a[g],d)}var g=a("./keys"),h=a("arraybuffer.slice"),m=a("base64-arraybuffer"),q=a("after"),n=a("utf8"),u=navigator.userAgent.match(/Android/i);e.protocol=3;var s=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},k=g(s),x={type:"error",data:"parser error"},G=a("blob");e.encodePacket=function(a,g,l,k){"function"==
typeof g&&(k=g,g=!1);"function"==typeof l&&(k=l,l=null);var h=void 0===a.data?void 0:a.data.buffer||a.data;if(b.ArrayBuffer&&h instanceof ArrayBuffer){if(g){l=a.data;g=new Uint8Array(l);l=new Uint8Array(1+l.byteLength);l[0]=s[a.type];for(a=0;a<g.length;a++)l[a+1]=g[a];a=k(l.buffer)}else a=e.encodeBase64Packet(a,k);return a}if(G&&h instanceof b.Blob)return g?u?a=f(a,g,k):(g=new Uint8Array(1),g[0]=s[a.type],a=new G([g.buffer,a.data]),a=k(a)):a=e.encodeBase64Packet(a,k),a;g=s[a.type];void 0!==a.data&&
(g+=l?n.encode(String(a.data)):String(a.data));return k(""+g)};e.encodeBase64Packet=function(a,f){var g="b"+e.packets[a.type];if(G&&a.data instanceof G){var l=new FileReader;l.onload=function(){var a=l.result.split(",")[1];f(g+a)};return l.readAsDataURL(a.data)}var k;try{k=String.fromCharCode.apply(null,new Uint8Array(a.data))}catch(h){k=new Uint8Array(a.data);for(var m=Array(k.length),n=0;n<k.length;n++)m[n]=k[n];k=String.fromCharCode.apply(null,m)}g+=b.btoa(k);return f(g)};e.decodePacket=function(a,
b,d){if("string"==typeof a||void 0===a){if("b"==a.charAt(0))return e.decodeBase64Packet(a.substr(1),b);if(d)try{a=n.decode(a)}catch(f){return x}d=a.charAt(0);return Number(d)==d&&k[d]?1<a.length?{type:k[d],data:a.substring(1)}:{type:k[d]}:x}d=(new Uint8Array(a))[0];a=h(a,1);G&&"blob"===b&&(a=new G([a]));return{type:k[d],data:a}};e.decodeBase64Packet=function(a,e){var f=k[a.charAt(0)];if(!b.ArrayBuffer)return{type:f,data:{base64:!0,data:a.substr(1)}};var g=m.decode(a.substr(1));"blob"===e&&G&&(g=new G([g]));
return{type:f,data:g}};e.encodePayload=function(a,b,d){"function"==typeof b&&(d=b,b=null);if(b)return G&&!u?e.encodePayloadAsBlob(a,d):e.encodePayloadAsArrayBuffer(a,d);if(!a.length)return d("0:");l(a,function(a,d){e.encodePacket(a,b,!0,function(a){d(null,a.length+":"+a)})},function(a,b){return d(b.join(""))})};e.decodePayload=function(a,b,d){if("string"!=typeof a)return e.decodePayloadAsBinary(a,b,d);"function"===typeof b&&(d=b,b=null);var f;if(""==a)return d(x,0,1);f="";for(var g,l,k=0,h=a.length;k<
h;k++)if(l=a.charAt(k),":"!=l)f+=l;else{if(""==f||f!=(g=Number(f)))return d(x,0,1);l=a.substr(k+1,g);if(f!=l.length)return d(x,0,1);if(l.length){f=e.decodePacket(l,b,!0);if(x.type==f.type&&x.data==f.data)return d(x,0,1);if(!1===d(f,k+g,h))return}k+=g;f=""}if(""!=f)return d(x,0,1)};e.encodePayloadAsArrayBuffer=function(a,b){if(!a.length)return b(new ArrayBuffer(0));l(a,function(a,b){e.encodePacket(a,!0,!0,function(a){return b(null,a)})},function(a,d){var e=d.reduce(function(a,b){var d;d="string"===
typeof b?b.length:b.byteLength;return a+d.toString().length+d+2},0),f=new Uint8Array(e),g=0;d.forEach(function(a){var b="string"===typeof a,d=a;if(b){for(var d=new Uint8Array(a.length),e=0;e<a.length;e++)d[e]=a.charCodeAt(e);d=d.buffer}b?f[g++]=0:f[g++]=1;a=d.byteLength.toString();for(e=0;e<a.length;e++)f[g++]=parseInt(a[e]);f[g++]=255;d=new Uint8Array(d);for(e=0;e<d.length;e++)f[g++]=d[e]});return b(f.buffer)})};e.encodePayloadAsBlob=function(a,b){l(a,function(a,b){e.encodePacket(a,!0,!0,function(a){var d=
new Uint8Array(1);d[0]=1;if("string"===typeof a){for(var e=new Uint8Array(a.length),f=0;f<a.length;f++)e[f]=a.charCodeAt(f);a=e.buffer;d[0]=0}for(var e=(a instanceof ArrayBuffer?a.byteLength:a.size).toString(),g=new Uint8Array(e.length+1),f=0;f<e.length;f++)g[f]=parseInt(e[f]);g[e.length]=255;G&&(a=new G([d.buffer,g.buffer,a]),b(null,a))})},function(a,d){return b(new G(d))})};e.decodePayloadAsBinary=function(a,b,d){"function"===typeof b&&(d=b,b=null);for(var f=[],g=!1;0<a.byteLength;){for(var l=new Uint8Array(a),
k=0===l[0],m="",n=1;255!=l[n];n++){if(310<m.length){g=!0;break}m+=l[n]}if(g)return d(x,0,1);a=h(a,2+m.length);m=parseInt(m);l=h(a,0,m);if(k)try{l=String.fromCharCode.apply(null,new Uint8Array(l))}catch(s){for(k=new Uint8Array(l),l="",n=0;n<k.length;n++)l+=String.fromCharCode(k[n])}f.push(l);a=h(a,m)}var q=f.length;f.forEach(function(a,f){d(e.decodePacket(a,b,!0),f,q)})}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./keys":22,after:23,"arraybuffer.slice":24,
"base64-arraybuffer":25,blob:26,utf8:27}],22:[function(a,b,e){b.exports=Object.keys||function(a){var b=[],e=Object.prototype.hasOwnProperty,g;for(g in a)e.call(a,g)&&b.push(g);return b}},{}],23:[function(a,b,e){function d(){}b.exports=function(a,b,e){function h(a,d){if(0>=h.count)throw Error("after called too many times");--h.count;a?(m=!0,b(a),b=e):0!==h.count||m||b(null,d)}var m=!1;e=e||d;h.count=a;return 0===a?b():h}},{}],24:[function(a,b,e){b.exports=function(a,b,e){var g=a.byteLength;b=b||0;
e=e||g;if(a.slice)return a.slice(b,e);0>b&&(b+=g);0>e&&(e+=g);e>g&&(e=g);if(b>=g||b>=e||0===g)return new ArrayBuffer(0);a=new Uint8Array(a);for(var g=new Uint8Array(e-b),h=0;b<e;b++,h++)g[h]=a[b];return g.buffer}},{}],25:[function(a,b,e){(function(a){e.encode=function(b){b=new Uint8Array(b);var e,g=b.length,h="";for(e=0;e<g;e+=3)h+=a[b[e]>>2],h+=a[(b[e]&3)<<4|b[e+1]>>4],h+=a[(b[e+1]&15)<<2|b[e+2]>>6],h+=a[b[e+2]&63];2===g%3?h=h.substring(0,h.length-1)+"=":1===g%3&&(h=h.substring(0,h.length-2)+"==");
return h};e.decode=function(b){var e=0.75*b.length,g=b.length,h=0,m,q,n,u;"="===b[b.length-1]&&(e--,"="===b[b.length-2]&&e--);for(var s=new ArrayBuffer(e),k=new Uint8Array(s),e=0;e<g;e+=4)m=a.indexOf(b[e]),q=a.indexOf(b[e+1]),n=a.indexOf(b[e+2]),u=a.indexOf(b[e+3]),k[h++]=m<<2|q>>4,k[h++]=(q&15)<<4|n>>2,k[h++]=(n&3)<<6|u&63;return s}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],26:[function(a,b,e){(function(a){function e(a,b){b=b||{};for(var d=new l,f=0;f<a.length;f++)d.append(a[f]);
return b.type?d.getBlob(b.type):d.getBlob()}var l=a.BlobBuilder||a.WebKitBlobBuilder||a.MSBlobBuilder||a.MozBlobBuilder,g;try{g=2==(new Blob(["hi"])).size}catch(h){g=!1}var m=l&&l.prototype.append&&l.prototype.getBlob;a=g?a.Blob:m?e:void 0;b.exports=a}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],27:[function(a,b,e){(function(a){(function(f){function l(a){for(var b=[],d=0,e=a.length,f,g;d<e;)f=a.charCodeAt(d++),55296<=f&&56319>=f&&d<e?(g=a.charCodeAt(d++),
56320==(g&64512)?b.push(((f&1023)<<10)+(g&1023)+65536):(b.push(f),d--)):b.push(f);return b}function g(){if(x>=k)throw Error("Invalid byte index");var a=s[x]&255;x++;if(128==(a&192))return a&63;throw Error("Invalid continuation byte");}function h(){var a,b,d,e;if(x>k)throw Error("Invalid byte index");if(x==k)return!1;a=s[x]&255;x++;if(0==(a&128))return a;if(192==(a&224)){b=g();a=(a&31)<<6|b;if(128<=a)return a;throw Error("Invalid continuation byte");}if(224==(a&240)){b=g();d=g();a=(a&15)<<12|b<<6|
d;if(2048<=a)return a;throw Error("Invalid continuation byte");}if(240==(a&248)&&(b=g(),d=g(),e=g(),a=(a&15)<<18|b<<12|d<<6|e,65536<=a&&1114111>=a))return a;throw Error("Invalid UTF-8 detected");}var m="object"==typeof e&&e,q="object"==typeof b&&b&&b.exports==m&&b,n="object"==typeof a&&a;if(n.global===n||n.window===n)f=n;var u=String.fromCharCode,s,k,x,n={version:"2.0.0",encode:function(a){a=l(a);for(var b=a.length,d=-1,e,f="";++d<b;){e=a[d];if(0==(e&4294967168))e=u(e);else{var g="";0==(e&4294965248)?
g=u(e>>6&31|192):0==(e&4294901760)?(g=u(e>>12&15|224),g+=u(e>>6&63|128)):0==(e&4292870144)&&(g=u(e>>18&7|240),g+=u(e>>12&63|128),g+=u(e>>6&63|128));e=g+=u(e&63|128)}f+=e}return f},decode:function(a){s=l(a);k=s.length;x=0;a=[];for(var b;!1!==(b=h());)a.push(b);b=a.length;for(var d=-1,e,f="";++d<b;)e=a[d],65535<e&&(e-=65536,f+=u(e>>>10&1023|55296),e=56320|e&1023),f+=u(e);return f}};if(m&&!m.nodeType)if(q)q.exports=n;else{f={}.hasOwnProperty;for(var G in n)f.call(n,G)&&(m[G]=n[G])}else f.utf8=n})(this)}).call(this,
"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],28:[function(a,b,e){(function(a){var e=/^[\],:{}\s]*$/,l=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,g=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,h=/(?:^|:|,)(?:\s*\[)+/g,m=/^\s+/,q=/\s+$/;b.exports=function(b){if("string"!=typeof b||!b)return null;b=b.replace(m,"").replace(q,"");if(a.JSON&&JSON.parse)return JSON.parse(b);if(e.test(b.replace(l,"@").replace(g,"]").replace(h,"")))return(new Function("return "+
b))()}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],29:[function(a,b,e){e.encode=function(a){var b="",e;for(e in a)a.hasOwnProperty(e)&&(b.length&&(b+="&"),b+=encodeURIComponent(e)+"="+encodeURIComponent(a[e]));return b};e.decode=function(a){var b={};a=a.split("&");for(var e=0,g=a.length;e<g;e++){var h=a[e].split("=");b[decodeURIComponent(h[0])]=decodeURIComponent(h[1])}return b}},{}],30:[function(a,b,e){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
f="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");b.exports=function(a){var b=a,e=a.indexOf("["),m=a.indexOf("]");-1!=e&&-1!=m&&(a=a.substring(0,e)+a.substring(e,m).replace(/:/g,";")+a.substring(m,a.length));a=d.exec(a||"");for(var q={},n=14;n--;)q[f[n]]=a[n]||"";-1!=e&&-1!=m&&(q.source=b,q.host=q.host.substring(1,q.host.length-1).replace(/;/g,":"),q.authority=q.authority.replace("[","").replace("]","").replace(/;/g,":"),q.ipv6uri=
!0);return q}},{}],31:[function(a,b,e){function d(a,b,d){return b?new f(a,b):new f(a)}a=function(){return this}();var f=a.WebSocket||a.MozWebSocket;b.exports=f?d:null;f&&(d.prototype=f.prototype)},{}],32:[function(a,b,e){(function(d){var e=a("isarray");b.exports=function(a){function b(a){if(!a)return!1;if(d.Buffer&&d.Buffer.isBuffer(a)||d.ArrayBuffer&&a instanceof ArrayBuffer||d.Blob&&a instanceof Blob||d.File&&a instanceof File)return!0;if(e(a))for(var l=0;l<a.length;l++){if(b(a[l]))return!0}else if(a&&
"object"==typeof a)for(l in a.toJSON&&(a=a.toJSON()),a)if(a.hasOwnProperty(l)&&b(a[l]))return!0;return!1}return b(a)}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{isarray:33}],33:[function(a,b,e){b.exports=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)}},{}],34:[function(a,b,e){a=a("global");try{b.exports="XMLHttpRequest"in a&&"withCredentials"in new a.XMLHttpRequest}catch(d){b.exports=!1}},{global:35}],35:[function(a,b,
e){b.exports=function(){return this}()},{}],36:[function(a,b,e){var d=[].indexOf;b.exports=function(a,b){if(d)return a.indexOf(b);for(var e=0;e<a.length;++e)if(a[e]===b)return e;return-1}},{}],37:[function(a,b,e){var d=Object.prototype.hasOwnProperty;e.keys=Object.keys||function(a){var b=[],e;for(e in a)d.call(a,e)&&b.push(e);return b};e.values=function(a){var b=[],e;for(e in a)d.call(a,e)&&b.push(a[e]);return b};e.merge=function(a,b){for(var e in b)d.call(b,e)&&(a[e]=b[e]);return a};e.length=function(a){return e.keys(a).length};
e.isEmpty=function(a){return 0==e.length(a)}},{}],38:[function(a,b,e){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,f="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");b.exports=function(a){a=d.exec(a||"");for(var b={},e=14;e--;)b[f[e]]=a[e]||
"";return b}},{}],39:[function(a,b,e){(function(b){var f=a("isarray"),l=a("./is-buffer");e.deconstructPacket=function(a){function b(a){if(!a)return a;if(l(a)){var e={_placeholder:!0,num:d.length};d.push(a);return e}if(f(a)){for(var e=Array(a.length),g=0;g<a.length;g++)e[g]=b(a[g]);return e}if("object"==typeof a&&!(a instanceof Date)){e={};for(g in a)e[g]=b(a[g]);return e}return a}var d=[];a.data=b(a.data);a.attachments=d.length;return{packet:a,buffers:d}};e.reconstructPacket=function(a,b){function d(a){if(a&&
a._placeholder)return b[a.num];if(f(a))for(var e=0;e<a.length;e++)a[e]=d(a[e]);else if(a&&"object"==typeof a)for(e in a)a[e]=d(a[e]);return a}a.data=d(a.data);a.attachments=void 0;return a};e.removeBlobs=function(a,e){function m(a,g,k){if(!a)return a;if(b.Blob&&a instanceof Blob||b.File&&a instanceof File){q++;var x=new FileReader;x.onload=function(){k?k[g]=this.result:n=this.result;--q||e(n)};x.readAsArrayBuffer(a)}else if(f(a))for(x=0;x<a.length;x++)m(a[x],x,a);else if(a&&"object"==typeof a&&!l(a))for(x in a)m(a[x],
x,a)}var q=0,n=a;m(n);q||e(n)}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./is-buffer":41,isarray:42}],40:[function(a,b,e){function d(){}function f(a){var b,d=!1;b=""+a.type;if(e.BINARY_EVENT==a.type||e.BINARY_ACK==a.type)b+=a.attachments,b+="-";a.nsp&&"/"!=a.nsp&&(d=!0,b+=a.nsp);null!=a.id&&(d&&(b+=",",d=!1),b+=a.id);null!=a.data&&(d&&(b+=","),b+=q.stringify(a.data));m("encoded %j as %s",a,b);return b}function l(a,b){n.removeBlobs(a,function(a){var d=n.deconstructPacket(a);
a=f(d.packet);d=d.buffers;d.unshift(a);b(d)})}function g(){this.reconstructor=null}function h(a){this.reconPack=a;this.buffers=[]}var m=a("debug")("socket.io-parser"),q=a("json3");a("isarray");b=a("component-emitter");var n=a("./binary"),u=a("./is-buffer");e.protocol=4;e.types="CONNECT DISCONNECT EVENT BINARY_EVENT ACK BINARY_ACK ERROR".split(" ");e.CONNECT=0;e.DISCONNECT=1;e.EVENT=2;e.ACK=3;e.ERROR=4;e.BINARY_EVENT=5;e.BINARY_ACK=6;e.Encoder=d;e.Decoder=g;d.prototype.encode=function(a,b){m("encoding packet %j",
a);if(e.BINARY_EVENT==a.type||e.BINARY_ACK==a.type)l(a,b);else{var d=f(a);b([d])}};b(g.prototype);g.prototype.add=function(a){if("string"==typeof a){a:{var b={},d=0;b.type=Number(a.charAt(0));if(null==e.types[b.type])a={type:e.ERROR,data:"parser error"};else{if(e.BINARY_EVENT==b.type||e.BINARY_ACK==b.type){for(b.attachments="";"-"!=a.charAt(++d);)b.attachments+=a.charAt(d);b.attachments=Number(b.attachments)}if("/"==a.charAt(d+1))for(b.nsp="";++d;){var f=a.charAt(d);if(","==f)break;b.nsp+=f;if(d+
1==a.length)break}else b.nsp="/";f=a.charAt(d+1);if(""!=f&&Number(f)==f){for(b.id="";++d;){f=a.charAt(d);if(null==f||Number(f)!=f){--d;break}b.id+=a.charAt(d);if(d+1==a.length)break}b.id=Number(b.id)}if(a.charAt(++d))try{b.data=q.parse(a.substr(d))}catch(g){a={type:e.ERROR,data:"parser error"};break a}m("decoded %s as %j",a,b);a=b}}e.BINARY_EVENT==a.type||e.BINARY_ACK==a.type?(this.reconstructor=new h(a),0==this.reconstructor.reconPack.attachments&&this.emit("decoded",a)):this.emit("decoded",a)}else if(u(a)||
a.base64)if(this.reconstructor){if(a=this.reconstructor.takeBinaryData(a))this.reconstructor=null,this.emit("decoded",a)}else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+a);};g.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};h.prototype.takeBinaryData=function(a){this.buffers.push(a);return this.buffers.length==this.reconPack.attachments?(a=n.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),
a):null};h.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]}},{"./binary":39,"./is-buffer":41,"component-emitter":8,debug:9,isarray:42,json3:43}],41:[function(a,b,e){(function(a){b.exports=function(b){return a.Buffer&&a.Buffer.isBuffer(b)||a.ArrayBuffer&&b instanceof ArrayBuffer}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],42:[function(a,b,e){b.exports=a(33)},{}],43:[function(a,b,e){(function(a){function b(a){if(b[a]!==m)return b[a];
var d;if("bug-string-char-index"==a)d="a"!="a"[0];else if("json"==a)d=b("json-stringify")&&b("json-parse");else{var e;if("json-stringify"==a){d=n.stringify;var g="function"==typeof d&&u;if(g){(e=function(){return 1}).toJSON=e;try{g="0"===d(0)&&"0"===d(new Number)&&'""'==d(new String)&&d(l)===m&&d(m)===m&&d()===m&&"1"===d(e)&&"[1]"==d([e])&&"[null]"==d([m])&&"null"==d(null)&&"[null,null,null]"==d([m,l,null])&&'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==d({a:[e,!0,!1,null,"\x00\b\n\f\r\t"]})&&
"1"===d(null,e)&&"[\n 1,\n 2\n]"==d([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==d(new Date(-864E13))&&'"+275760-09-13T00:00:00.000Z"'==d(new Date(864E13))&&'"-000001-01-01T00:00:00.000Z"'==d(new Date(-621987552E5))&&'"1969-12-31T23:59:59.999Z"'==d(new Date(-1))}catch(k){g=!1}}d=g}if("json-parse"==a){d=n.parse;if("function"==typeof d)try{if(0===d("0")&&!d(!1)){e=d('{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}');var h=5==e.a.length&&1===e.a[0];if(h){try{h=!d('"\t"')}catch(H){}if(h)try{h=1!==
d("01")}catch(q){}if(h)try{h=1!==d("1.")}catch(s){}}}}catch(p){h=!1}d=h}}return b[a]=!!d}var l={}.toString,g,h,m,q="object"==typeof JSON&&JSON,n="object"==typeof e&&e&&!e.nodeType&&e;n&&q?(n.stringify=q.stringify,n.parse=q.parse):n=a.JSON=q||{};var u=new Date(-0xc782b5b800cec);try{u=-109252==u.getUTCFullYear()&&0===u.getUTCMonth()&&1===u.getUTCDate()&&10==u.getUTCHours()&&37==u.getUTCMinutes()&&6==u.getUTCSeconds()&&708==u.getUTCMilliseconds()}catch(s){}if(!b("json")){var k=b("bug-string-char-index");
if(!u)var x=Math.floor,G=[0,31,59,90,120,151,181,212,243,273,304,334],W=function(a,b){return G[b]+365*(a-1970)+x((a-1969+(b=+(1<b)))/4)-x((a-1901+b)/100)+x((a-1601+b)/400)};(g={}.hasOwnProperty)||(g=function(a){var b={},d;(b.__proto__=null,b.__proto__={toString:1},b).toString!=l?g=function(a){var b=this.__proto__;a=a in(this.__proto__=null,this);this.__proto__=b;return a}:(d=b.constructor,g=function(a){var b=(this.constructor||d).prototype;return a in this&&!(a in b&&this[a]===b[a])});b=null;return g.call(this,
a)});var Ja={"boolean":1,number:1,string:1,undefined:1};h=function(a,b){var d=0,e,f,k;(e=function(){this.valueOf=0}).prototype.valueOf=0;f=new e;for(k in f)g.call(f,k)&&d++;e=f=null;d?h=2==d?function(a,b){var d={},e="[object Function]"==l.call(a),f;for(f in a)e&&"prototype"==f||(g.call(d,f)||!(d[f]=1)||!g.call(a,f))||b(f)}:function(a,b){var d="[object Function]"==l.call(a),e,f;for(e in a)d&&"prototype"==e||(!g.call(a,e)||(f="constructor"===e))||b(e);(f||g.call(a,e="constructor"))&&b(e)}:(f="valueOf toString toLocaleString propertyIsEnumerable isPrototypeOf hasOwnProperty constructor".split(" "),
h=function(a,b){var d="[object Function]"==l.call(a),e,k;if(k=!d)if(k="function"!=typeof a.constructor)k=typeof a.hasOwnProperty,k="object"==k?!!a.hasOwnProperty:!Ja[k];k=k?a.hasOwnProperty:g;for(e in a)d&&"prototype"==e||!k.call(a,e)||b(e);for(d=f.length;e=f[--d];k.call(a,e)&&b(e));});return h(a,b)};if(!b("json-stringify")){var Ya={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},oa=function(a,b){return("000000"+(b||0)).slice(-a)},Ta=function(a){var b='"',d=0,e=a.length,f=10<e&&k,g;
for(f&&(g=a.split(""));d<e;d++){var h=a.charCodeAt(d);switch(h){case 8:case 9:case 10:case 12:case 13:case 34:case 92:b+=Ya[h];break;default:if(32>h){b+="\\u00"+oa(2,h.toString(16));break}b+=f?g[d]:k?a.charAt(d):a[d]}}return b+'"'},ea=function(a,b,d,e,f,k,n){var q,s,p,u,w,t,Ja,A,z;try{q=b[a]}catch(r){}if("object"==typeof q&&q)if(s=l.call(q),"[object Date]"!=s||g.call(q,"toJSON"))"function"==typeof q.toJSON&&("[object Number]"!=s&&"[object String]"!=s&&"[object Array]"!=s||g.call(q,"toJSON"))&&(q=
q.toJSON(a));else if(q>-1/0&&q<1/0){if(W){u=x(q/864E5);for(s=x(u/365.2425)+1970-1;W(s+1,0)<=u;s++);for(p=x((u-W(s,0))/30.42);W(s,p+1)<=u;p++);u=1+u-W(s,p);w=(q%864E5+864E5)%864E5;t=x(w/36E5)%24;Ja=x(w/6E4)%60;A=x(w/1E3)%60;w%=1E3}else s=q.getUTCFullYear(),p=q.getUTCMonth(),u=q.getUTCDate(),t=q.getUTCHours(),Ja=q.getUTCMinutes(),A=q.getUTCSeconds(),w=q.getUTCMilliseconds();q=(0>=s||1E4<=s?(0>s?"-":"+")+oa(6,0>s?-s:s):oa(4,s))+"-"+oa(2,p+1)+"-"+oa(2,u)+"T"+oa(2,t)+":"+oa(2,Ja)+":"+oa(2,A)+"."+oa(3,
w)+"Z"}else q=null;d&&(q=d.call(b,a,q));if(null===q)return"null";s=l.call(q);if("[object Boolean]"==s)return""+q;if("[object Number]"==s)return q>-1/0&&q<1/0?""+q:"null";if("[object String]"==s)return Ta(""+q);if("object"==typeof q){for(a=n.length;a--;)if(n[a]===q)throw TypeError();n.push(q);z=[];b=k;k+=f;if("[object Array]"==s){p=0;for(a=q.length;p<a;p++)s=ea(p,q,d,e,f,k,n),z.push(s===m?"null":s);a=z.length?f?"[\n"+k+z.join(",\n"+k)+"\n"+b+"]":"["+z.join(",")+"]":"[]"}else h(e||q,function(a){var b=
ea(a,q,d,e,f,k,n);b!==m&&z.push(Ta(a)+":"+(f?" ":"")+b)}),a=z.length?f?"{\n"+k+z.join(",\n"+k)+"\n"+b+"}":"{"+z.join(",")+"}":"{}";n.pop();return a}};n.stringify=function(a,b,d){var e,f,g,k;if("function"==typeof b||"object"==typeof b&&b)if("[object Function]"==(k=l.call(b)))f=b;else if("[object Array]"==k){g={};for(var h=0,m=b.length,p;h<m;p=b[h++],(k=l.call(p),"[object String]"==k||"[object Number]"==k)&&(g[p]=1));}if(d)if("[object Number]"==(k=l.call(d))){if(0<(d-=d%1))for(e="",10<d&&(d=10);e.length<
d;e+=" ");}else"[object String]"==k&&(e=10>=d.length?d:d.slice(0,10));return ea("",(p={},p[""]=a,p),f,g,e,"",[])}}if(!b("json-parse")){var Ka=String.fromCharCode,Aa={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},w,K,z=function(){w=K=null;throw SyntaxError();},V=function(){for(var a=K,b=a.length,d,e,f,g,h;w<b;)switch(h=a.charCodeAt(w),h){case 9:case 10:case 13:case 32:w++;break;case 123:case 125:case 91:case 93:case 58:case 44:return d=k?a.charAt(w):a[w],w++,d;case 34:d="@";for(w++;w<
b;)if(h=a.charCodeAt(w),32>h)z();else if(92==h)switch(h=a.charCodeAt(++w),h){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:d+=Aa[h];w++;break;case 117:e=++w;for(f=w+4;w<f;w++)h=a.charCodeAt(w),48<=h&&57>=h||(97<=h&&102>=h||65<=h&&70>=h)||z();d+=Ka("0x"+a.slice(e,w));break;default:z()}else{if(34==h)break;h=a.charCodeAt(w);for(e=w;32<=h&&92!=h&&34!=h;)h=a.charCodeAt(++w);d+=a.slice(e,w)}if(34==a.charCodeAt(w))return w++,d;z();default:e=w;45==h&&(g=!0,h=a.charCodeAt(++w));if(48<=
h&&57>=h){for(48==h&&(h=a.charCodeAt(w+1),48<=h&&57>=h)&&z();w<b&&(h=a.charCodeAt(w),48<=h&&57>=h);w++);if(46==a.charCodeAt(w)){for(f=++w;f<b&&(h=a.charCodeAt(f),48<=h&&57>=h);f++);f==w&&z();w=f}h=a.charCodeAt(w);if(101==h||69==h){h=a.charCodeAt(++w);43!=h&&45!=h||w++;for(f=w;f<b&&(h=a.charCodeAt(f),48<=h&&57>=h);f++);f==w&&z();w=f}return+a.slice(e,w)}g&&z();if("true"==a.slice(w,w+4))return w+=4,!0;if("false"==a.slice(w,w+5))return w+=5,!1;if("null"==a.slice(w,w+4))return w+=4,null;z()}return"$"},
sa=function(a){var b,d;"$"==a&&z();if("string"==typeof a){if("@"==(k?a.charAt(0):a[0]))return a.slice(1);if("["==a){for(b=[];;d||(d=!0)){a=V();if("]"==a)break;d&&(","==a?(a=V(),"]"==a&&z()):z());","==a&&z();b.push(sa(a))}return b}if("{"==a){for(b={};;d||(d=!0)){a=V();if("}"==a)break;d&&(","==a?(a=V(),"}"==a&&z()):z());","!=a&&"string"==typeof a&&"@"==(k?a.charAt(0):a[0])&&":"==V()||z();b[a.slice(1)]=sa(V())}return b}z()}return a},na=function(a,b,d){d=za(a,b,d);d===m?delete a[b]:a[b]=d},za=function(a,
b,d){var e=a[b],f;if("object"==typeof e&&e)if("[object Array]"==l.call(e))for(f=e.length;f--;)na(e,f,d);else h(e,function(a){na(e,a,d)});return d.call(a,b,e)};n.parse=function(a,b){var d,e;w=0;K=""+a;d=sa(V());"$"!=V()&&z();w=K=null;return b&&"[object Function]"==l.call(b)?za((e={},e[""]=d,e),"",b):d}}}})(this)},{}],44:[function(a,b,e){b.exports=function(a,b){for(var e=[],g=(b=b||0)||0;g<a.length;g++)e[g-b]=a[g];return e}},{}]},{},[1])(1)});(function(c){"function"===typeof define&&define.amd?define(["jquery"],c):"object"==typeof exports&&"object"==typeof module?module.exports=c:c(jQuery)})(function(c,a){function b(a,b,d,e){for(var f=[],g=0;g<a.length;g++){var h=a[g];if(h){var l=tinycolor(h),m=0.5>l.toHsl().l?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light",m=m+(tinycolor.equals(b,h)?" sp-thumb-active":""),h=l.toString(e.preferredFormat||"rgb"),n=k?"background-color:"+l.toRgbString():"filter:"+l.toFilter();f.push('<span title="'+
h+'" data-color="'+l.toRgbString()+'" class="'+m+'"><span class="sp-thumb-inner" style="'+n+';" /></span>')}else f.push(c("<div />").append(c('<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>').attr("title",e.noColorSelectedText)).html())}return"<div class='sp-cf "+d+"'>"+f.join("")+"</div>"}function e(a,b){var d=c.extend({},n,a);d.callbacks={move:h(d.move,b),change:h(d.change,b),show:h(d.show,b),hide:h(d.hide,b),beforeShow:h(d.beforeShow,b)};return d}function d(d,
h){function l(){p.showPaletteOnly&&(p.showPalette=!0);Ba.text(p.showPaletteOnly?p.togglePaletteMoreText:p.togglePaletteLessText);if(p.palette){pa=p.palette.slice(0);fa=c.isArray(pa[0])?pa:[pa];qa={};for(var a=0;a<fa.length;a++)for(var b=0;b<fa[a].length;b++){var d=tinycolor(fa[a][b]).toRgbString();qa[d]=!0}}v.toggleClass("sp-flat",L);v.toggleClass("sp-input-disabled",!p.showInput);v.toggleClass("sp-alpha-enabled",p.showAlpha);v.toggleClass("sp-clear-enabled",X);v.toggleClass("sp-buttons-disabled",
!p.showButtons);v.toggleClass("sp-palette-buttons-disabled",!p.togglePaletteOnly);v.toggleClass("sp-palette-disabled",!p.showPalette);v.toggleClass("sp-palette-only",p.showPaletteOnly);v.toggleClass("sp-initial-disabled",!p.showInitial);v.addClass(p.className).addClass(p.containerClassName);I()}function n(){if(t&&window.localStorage){try{var a=window.localStorage[t].split(",#");1<a.length&&(delete window.localStorage[t],c.each(a,function(a,c){ea(c)}))}catch(b){}try{M=window.localStorage[t].split(";")}catch(d){}}}
function ea(a){if(Q){a=tinycolor(a).toRgbString();if(!qa[a]&&-1===c.inArray(a,M))for(M.push(a);M.length>Ua;)M.shift();if(t&&window.localStorage)try{window.localStorage[t]=M.join(";")}catch(b){}}}function Ka(){var a=[];if(p.showPalette)for(var c=0;c<M.length;c++){var b=tinycolor(M[c]).toRgbString();qa[b]||a.push(M[c])}return a.reverse().slice(0,p.maxSelectionSize)}function Aa(){var a=E(),d=c.map(fa,function(c,d){return b(c,a,"sp-palette-row sp-palette-row-"+d,p)});n();M&&d.push(b(Ka(),a,"sp-palette-row sp-palette-row-selection",
p));La.html(d.join(""))}function w(){if(p.showInitial){var a=Y,c=E();Ma.html(b([a,c],c,"sp-palette-row-initial",p))}}function K(){(0>=J||0>=N||0>=ra)&&I();v.addClass(Na);R=null;C.trigger("dragstart.spectrum",[E()])}function z(){v.removeClass(Na);C.trigger("dragstop.spectrum",[E()])}function V(){var a=S.val();null!==a&&""!==a||!X?(a=tinycolor(a),a.isValid()?(T(a),H(!0)):S.addClass("sp-validation-error")):(T(null),H(!0))}function sa(){r?Z():na()}function na(){var a=c.Event("beforeShow.spectrum");if(r)I();
else if(C.trigger(a,[E()]),!1!==A.beforeShow(E())&&!a.isDefaultPrevented()){for(a=0;a<u.length;a++)u[a]&&u[a].hide();r=!0;c(Ca).bind("click.spectrum",za);c(window).bind("resize.spectrum",aa);ba.addClass("sp-active");v.removeClass("sp-hidden");I();P();Y=E();w();A.show(Y);C.trigger("show.spectrum",[Y])}}function za(a){2!=a.button&&(Va?H(!0):T(Y,!0),Z())}function Z(){r&&!L&&(r=!1,c(Ca).unbind("click.spectrum",za),c(window).unbind("resize.spectrum",aa),ba.removeClass("sp-active"),v.addClass("sp-hidden"),
A.hide(E()),C.trigger("hide.spectrum",[E()]))}function T(a,c){if(tinycolor.equals(a,E()))P();else{var b,d;!a&&X?U=!0:(U=!1,b=tinycolor(a),d=b.toHsv(),ga=d.h%360/360,ha=d.s,ia=d.v,O=d.a);P();b&&(b.isValid()&&!c)&&(ja=Da||b.getFormat())}}function E(a){a=a||{};return X&&U?null:tinycolor.fromRatio({h:ga,s:ha,v:ia,a:Math.round(100*O)/100},{format:a.format||ja})}function ca(){P();A.move(E());C.trigger("move.spectrum",[E()])}function P(){S.removeClass("sp-validation-error");y();var a=tinycolor.fromRatio({h:ga,
s:1,v:1});ta.css("background-color",a.toHexString());a=ja;!(1>O)||0===O&&"name"===a||"hex"!==a&&"hex3"!==a&&"hex6"!==a&&"name"!==a||(a="rgb");var c=E({format:a}),b="";da.removeClass("sp-clear-display");da.css("background-color","transparent");if(!c&&X)da.addClass("sp-clear-display");else{var b=c.toHexString(),d=c.toRgbString();k||1===c.alpha?da.css("background-color",d):(da.css("background-color","transparent"),da.css("filter",c.toFilter()));if(p.showAlpha){d=c.toRgb();d.a=0;var d=tinycolor(d).toRgbString(),
e="linear-gradient(left, "+d+", "+b+")";s?ka.css("filter",tinycolor(d).toFilter({gradientType:1},b)):(ka.css("background","-webkit-"+e),ka.css("background","-moz-"+e),ka.css("background","-ms-"+e),ka.css("background","linear-gradient(to right, "+d+", "+b+")"))}b=c.toString(a)}p.showInput&&S.val(b);p.showPalette&&Aa();w()}function y(){var a=ha,c=ia;X&&U?(ua.hide(),va.hide(),wa.hide()):(ua.show(),va.show(),wa.show(),a*=N,c=J-c*J,a=Math.max(-D,Math.min(N-D,a-D)),c=Math.max(-D,Math.min(J-D,c-D)),wa.css({top:c+
"px",left:a+"px"}),ua.css({left:O*B-Oa/2+"px"}),va.css({top:ga*ra-Pa+"px"}))}function H(a){var c=E(),b="",d=!tinycolor.equals(c,Y);c&&(b=c.toString(ja),ea(c));xa&&C.val(b);a&&d&&(A.change(c),C.trigger("change",[c]))}function I(){N=ta.width();J=ta.height();D=wa.height();Ea.width();ra=Ea.height();Pa=va.height();B=Qa.width();Oa=ua.width();L||(v.css("position","absolute"),p.offset?v.offset(p.offset):v.offset(f(v,la)));y();p.showPalette&&Aa();C.trigger("reflow.spectrum")}function Fa(){Z();Ga=!0;C.attr("disabled",
!0);la.addClass("sp-disabled")}var p=e(h,d),L=p.flat,Q=p.showSelectionPalette,t=p.localStorageKey,F=p.theme,A=p.callbacks,aa=q(I,10),r=!1,N=0,J=0,D=0,ra=0,B=0,Oa=0,Pa=0,ga=0,ha=0,ia=0,O=1,pa=[],fa=[],qa={},M=p.selectionPalette.slice(0),Ua=p.maxSelectionSize,Na="sp-dragging",R=null,Ca=d.ownerDocument,C=c(d),Ga=!1,v=c(W,Ca).addClass(F),Wa=v.find(".sp-picker-container"),ta=v.find(".sp-color"),wa=v.find(".sp-dragger"),Ea=v.find(".sp-hue"),va=v.find(".sp-slider"),ka=v.find(".sp-alpha-inner"),Qa=v.find(".sp-alpha"),
ua=v.find(".sp-alpha-handle"),S=v.find(".sp-input"),La=v.find(".sp-palette"),Ma=v.find(".sp-initial"),Ra=v.find(".sp-cancel"),Ha=v.find(".sp-clear"),Sa=v.find(".sp-choose"),Ba=v.find(".sp-palette-toggle"),xa=C.is("input"),Xa=xa&&x&&"color"===C.attr("type"),Ia=xa&&!L,ba=Ia?c(G).addClass(F).addClass(p.className).addClass(p.replacerClassName):c([]),la=Ia?ba:C,da=ba.find(".sp-preview-inner"),ma=p.color||xa&&C.val(),Y=!1,Da=p.preferredFormat,ja=Da,Va=!p.showButtons||p.clickoutFiresChange,U=!ma,X=p.allowEmpty&&
!Xa;(function(){function a(b){b.data&&b.data.ignore?(T(c(b.target).closest(".sp-thumb-el").data("color")),ca()):(T(c(b.target).closest(".sp-thumb-el").data("color")),ca(),H(!0),p.hideAfterPaletteSelect&&Z());return!1}s&&v.find("*:not(input)").attr("unselectable","on");l();Ia&&C.after(ba).hide();X||Ha.hide();if(L)C.after(v).hide();else{var b="parent"===p.appendTo?C.parent():c(p.appendTo);1!==b.length&&(b=c("body"));b.append(v)}n();la.bind("click.spectrum touchstart.spectrum",function(a){Ga||sa();a.stopPropagation();
c(a.target).is("input")||a.preventDefault()});(C.is(":disabled")||!0===p.disabled)&&Fa();v.click(g);S.change(V);S.bind("paste",function(){setTimeout(V,1)});S.keydown(function(a){13==a.keyCode&&V()});Ra.text(p.cancelText);Ra.bind("click.spectrum",function(a){a.stopPropagation();a.preventDefault();T(Y,!0);Z()});Ha.attr("title",p.clearText);Ha.bind("click.spectrum",function(a){a.stopPropagation();a.preventDefault();U=!0;ca();L&&H(!0)});Sa.text(p.chooseText);Sa.bind("click.spectrum",function(a){a.stopPropagation();
a.preventDefault();S.hasClass("sp-validation-error")||(H(!0),Z())});Ba.text(p.showPaletteOnly?p.togglePaletteMoreText:p.togglePaletteLessText);Ba.bind("click.spectrum",function(a){a.stopPropagation();a.preventDefault();p.showPaletteOnly=!p.showPaletteOnly;p.showPaletteOnly||L||v.css("left","-="+(Wa.outerWidth(!0)+5));l()});m(Qa,function(a,c,b){O=a/B;U=!1;b.shiftKey&&(O=Math.round(10*O)/10);ca()},K,z);m(Ea,function(a,c){ga=parseFloat(c/ra);U=!1;p.showAlpha||(O=1);ca()},K,z);m(ta,function(a,c,b){b.shiftKey?
R||(b=J-ia*J,R=Math.abs(a-ha*N)>Math.abs(c-b)?"x":"y"):R=null;b=!R||"y"===R;R&&"x"!==R||(ha=parseFloat(a/N));b&&(ia=parseFloat((J-c)/J));U=!1;p.showAlpha||(O=1);ca()},K,z);ma?(T(ma),P(),ja=Da||tinycolor(ma).format,ea(ma)):P();L&&na();b=s?"mousedown.spectrum":"click.spectrum touchstart.spectrum";La.delegate(".sp-thumb-el",b,a);Ma.delegate(".sp-thumb-el:nth-child(1)",b,{ignore:!0},a)})();var ya={show:na,hide:Z,toggle:sa,reflow:I,option:function(b,d){if(b===a)return c.extend({},p);if(d===a)return p[b];
p[b]=d;l()},enable:function(){Ga=!1;C.attr("disabled",!1);la.removeClass("sp-disabled")},disable:Fa,offset:function(a){p.offset=a;I()},set:function(a){T(a);H()},get:E,destroy:function(){C.show();la.unbind("click.spectrum touchstart.spectrum");v.remove();ba.remove();u[ya.id]=null},container:v};ya.id=u.push(ya)-1;return ya}function f(a,b){var d=a.outerWidth(),e=a.outerHeight(),f=b.outerHeight(),g=a[0].ownerDocument,h=g.documentElement,k=h.clientWidth+c(g).scrollLeft(),g=h.clientHeight+c(g).scrollTop(),
h=b.offset();h.top+=f;h.left-=Math.min(h.left,h.left+d>k&&k>d?Math.abs(h.left+d-k):0);h.top-=Math.min(h.top,h.top+e>g&&g>e?Math.abs(e+f-0):0);return h}function l(){}function g(a){a.stopPropagation()}function h(a,c){var b=Array.prototype.slice,d=b.call(arguments,2);return function(){return a.apply(c,d.concat(b.call(arguments)))}}function m(a,b,d,e){function f(a){a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault();a.returnValue=!1}function g(c){if(l){if(s&&9>k.documentMode&&
!c.button)return h();var d=c.originalEvent&&c.originalEvent.touches,e=d?d[0].pageY:c.pageY,d=Math.max(0,Math.min((d?d[0].pageX:c.pageX)-m.left,q)),e=Math.max(0,Math.min(e-m.top,n));u&&f(c);b.apply(a,[d,e,c])}}function h(){l&&(c(k).unbind(x),c(k.body).removeClass("sp-dragging"),e.apply(a,arguments));l=!1}b=b||function(){};d=d||function(){};e=e||function(){};var k=document,l=!1,m={},n=0,q=0,u="ontouchstart"in window,x={};x.selectstart=f;x.dragstart=f;x["touchmove mousemove"]=g;x["touchend mouseup"]=
h;c(a).bind("touchstart mousedown",function(b){(b.which?3==b.which:2==b.button)||l||!1===d.apply(a,arguments)||(l=!0,n=c(a).height(),q=c(a).width(),m=c(a).offset(),c(k).bind(x),c(k.body).addClass("sp-dragging"),u||g(b),f(b))})}function q(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null;a.apply(e,f)};c&&clearTimeout(d);if(c||!d)d=setTimeout(g,b)}}var n={beforeShow:l,move:l,change:l,show:l,hide:l,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!1,
showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:["#ffffff #000000 #ff0000 #ff8000 #ffff00 #008000 #0000ff #4b0082 #9400d3".split(" ")],
selectionPalette:[],disabled:!1,offset:null},u=[],s=!!/msie/i.exec(window.navigator.userAgent),k=function(){var a=document.createElement("div").style;a.cssText="background-color:rgba(0,0,0,.5)";return!!~(""+a.backgroundColor).indexOf("rgba")||!!~(""+a.backgroundColor).indexOf("hsla")}(),x=function(){var a=c("<input type='color' value='!' />")[0];return"color"===a.type&&"!"!==a.value}(),G="<div class='sp-replacer'><div class='sp-preview'><div class='sp-preview-inner'></div></div><div class='sp-dd'>&#9660;</div></div>",
W=function(){var a="";if(s)for(var b=1;6>=b;b++)a+="<div class='sp-"+b+"'></div>";return["<div class='sp-container sp-hidden'><div class='sp-palette-container'><div class='sp-palette sp-thumb sp-cf'></div><div class='sp-palette-button-container sp-cf'><button type='button' class='sp-palette-toggle'></button></div></div><div class='sp-picker-container'><div class='sp-top sp-cf'><div class='sp-fill'></div><div class='sp-top-inner'><div class='sp-color'><div class='sp-sat'><div class='sp-val'><div class='sp-dragger'></div></div></div></div><div class='sp-clear sp-clear-display'></div><div class='sp-hue'><div class='sp-slider'></div>",
a,"</div></div><div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div></div><div class='sp-input-container sp-cf'><input class='sp-input' type='text' spellcheck='false'  /></div><div class='sp-initial sp-thumb sp-cf'></div><div class='sp-button-container sp-cf'><a class='sp-cancel' href='#'></a><button type='button' class='sp-choose'></button></div></div></div>"].join("")}();c.fn.spectrum=function(a,b){if("string"==typeof a){var e=this,f=Array.prototype.slice.call(arguments,
1);this.each(function(){var b=u[c(this).data("spectrum.id")];if(b){var d=b[a];if(!d)throw Error("Spectrum: no such method: '"+a+"'");"get"==a?e=b.get():"container"==a?e=b.container:"option"==a?e=b.option.apply(b,f):"destroy"==a?(b.destroy(),c(this).removeData("spectrum.id")):d.apply(b,f)}});return e}return this.spectrum("destroy").each(function(){var b=c.extend({},a,c(this).data()),b=d(this,b);c(this).data("spectrum.id",b.id)})};c.fn.spectrum.load=!0;c.fn.spectrum.loadOpts={};c.fn.spectrum.draggable=
m;c.fn.spectrum.defaults=n;c.spectrum={};c.spectrum.localization={};c.spectrum.palettes={};c.fn.spectrum.processNativeColorInputs=function(){x||c("input[type=color]").spectrum({preferredFormat:"hex6"})};(function(){function a(b,c,d){b=y(b,255);c=y(c,255);d=y(d,255);var e=A(b,c,d),f=F(b,c,d),g,h=(e+f)/2;if(e==f)g=f=0;else{var k=e-f,f=0.5<h?k/(2-e-f):k/(e+f);switch(e){case b:g=(c-d)/k+(c<d?6:0);break;case c:g=(d-b)/k+2;break;case d:g=(b-c)/k+4}g/=6}return{h:g,s:f,l:h}}function b(a,c,d){function e(a,
b,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(b-a)*c:0.5>c?b:c<2/3?a+6*(b-a)*(2/3-c):a}a=y(a,360);c=y(c,100);d=y(d,100);if(0===c)d=c=a=d;else{var f=0.5>d?d*(1+c):d+c-d*c,g=2*d-f;d=e(g,f,a+1/3);c=e(g,f,a);a=e(g,f,a-1/3)}return{r:255*d,g:255*c,b:255*a}}function c(a,b,d){a=y(a,255);b=y(b,255);d=y(d,255);var e=A(a,b,d),f=F(a,b,d),g,h=e-f;if(e==f)g=0;else{switch(e){case a:g=(b-d)/h+(b<d?6:0);break;case b:g=(d-a)/h+2;break;case d:g=(a-b)/h+4}g/=6}return{h:g,s:0===e?0:h/e,v:e}}function d(a,b,c,e){a=[H(t(a).toString(16)),
H(t(b).toString(16)),H(t(c).toString(16))];return e&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}function e(a,b,c,d){return[H(Math.round(255*parseFloat(d)).toString(16)),H(t(a).toString(16)),H(t(b).toString(16)),H(t(c).toString(16))].join("")}function f(a,b){b=0===b?0:b||10;var c=r(a).toHsl();c.s-=b/100;c.s=F(1,A(0,c.s));return r(c)}function g(a,b){b=0===b?0:b||10;var c=r(a).toHsl();c.s+=b/100;
c.s=F(1,A(0,c.s));return r(c)}function h(a){return r(a).desaturate(100)}function k(a,b){b=0===b?0:b||10;var c=r(a).toHsl();c.l+=b/100;c.l=F(1,A(0,c.l));return r(c)}function l(a,b){b=0===b?0:b||10;var c=r(a).toRgb();c.r=A(0,F(255,c.r-t(255*-(b/100))));c.g=A(0,F(255,c.g-t(255*-(b/100))));c.b=A(0,F(255,c.b-t(255*-(b/100))));return r(c)}function m(a,b){b=0===b?0:b||10;var c=r(a).toHsl();c.l-=b/100;c.l=F(1,A(0,c.l));return r(c)}function n(a,b){var c=r(a).toHsl(),d=(t(c.h)+b)%360;c.h=0>d?360+d:d;return r(c)}
function q(a){a=r(a).toHsl();a.h=(a.h+180)%360;return r(a)}function s(a){var b=r(a).toHsl(),c=b.h;return[r(a),r({h:(c+120)%360,s:b.s,l:b.l}),r({h:(c+240)%360,s:b.s,l:b.l})]}function u(a){var b=r(a).toHsl(),c=b.h;return[r(a),r({h:(c+90)%360,s:b.s,l:b.l}),r({h:(c+180)%360,s:b.s,l:b.l}),r({h:(c+270)%360,s:b.s,l:b.l})]}function x(a){var b=r(a).toHsl(),c=b.h;return[r(a),r({h:(c+72)%360,s:b.s,l:b.l}),r({h:(c+216)%360,s:b.s,l:b.l})]}function E(a,b,c){b=b||6;c=c||30;var d=r(a).toHsl();c=360/c;a=[r(a)];for(d.h=
(d.h-(c*b>>1)+720)%360;--b;)d.h=(d.h+c)%360,a.push(r(d));return a}function G(a,b){b=b||6;for(var c=r(a).toHsv(),d=c.h,e=c.s,c=c.v,f=[],g=1/b;b--;)f.push(r({h:d,s:e,v:c})),c=(c+g)%1;return f}function P(a){a=parseFloat(a);if(isNaN(a)||0>a||1<a)a=1;return a}function y(a,b){"string"==typeof a&&(-1!=a.indexOf(".")&&1===parseFloat(a))&&(a="100%");var c="string"===typeof a&&-1!=a.indexOf("%");a=F(b,A(0,parseFloat(a)));c&&(a=parseInt(a*b,10)/100);return 1E-6>Q.abs(a-b)?1:a%b/parseFloat(b)}function H(a){return 1==
a.length?"0"+a:""+a}function I(a){1>=a&&(a=100*a+"%");return a}var W=/^[\s,#]+/,p=/\s+$/,L=0,Q=Math,t=Q.round,F=Q.min,A=Q.max,aa=Q.random,r=function B(a,c){var d,e,f,g,h;a=a?a:"";c=c||{};if(a instanceof B)return a;if(!(this instanceof B))return new B(a,c);e=a;h={r:0,g:0,b:0};var k=1;f=d=!1;if("string"==typeof e)a:{e=e.replace(W,"").replace(p,"").toLowerCase();var l=!1;if(N[e])e=N[e],l=!0;else if("transparent"==e){e={r:0,g:0,b:0,a:0,format:"name"};break a}e=(g=D.rgb.exec(e))?{r:g[1],g:g[2],b:g[3]}:
(g=D.rgba.exec(e))?{r:g[1],g:g[2],b:g[3],a:g[4]}:(g=D.hsl.exec(e))?{h:g[1],s:g[2],l:g[3]}:(g=D.hsla.exec(e))?{h:g[1],s:g[2],l:g[3],a:g[4]}:(g=D.hsv.exec(e))?{h:g[1],s:g[2],v:g[3]}:(g=D.hsva.exec(e))?{h:g[1],s:g[2],v:g[3],a:g[4]}:(g=D.hex8.exec(e))?{a:parseInt(g[1],16)/255,r:parseInt(g[2],16),g:parseInt(g[3],16),b:parseInt(g[4],16),format:l?"name":"hex8"}:(g=D.hex6.exec(e))?{r:parseInt(g[1],16),g:parseInt(g[2],16),b:parseInt(g[3],16),format:l?"name":"hex"}:(g=D.hex3.exec(e))?{r:parseInt(g[1]+""+g[1],
16),g:parseInt(g[2]+""+g[2],16),b:parseInt(g[3]+""+g[3],16),format:l?"name":"hex"}:!1}if("object"==typeof e){if(e.hasOwnProperty("r")&&e.hasOwnProperty("g")&&e.hasOwnProperty("b"))h={r:255*y(e.r,255),g:255*y(e.g,255),b:255*y(e.b,255)},d=!0,f="%"===String(e.r).substr(-1)?"prgb":"rgb";else if(e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("v")){e.s=I(e.s);e.v=I(e.v);f=e.h;l=e.s;h=e.v;f=6*y(f,360);l=y(l,100);h=y(h,100);d=Q.floor(f);var m=f-d;f=h*(1-l);g=h*(1-m*l);l=h*(1-(1-m)*l);d%=6;
h={r:255*[h,g,f,f,l,h][d],g:255*[l,h,h,g,f,f][d],b:255*[f,f,l,h,h,g][d]};d=!0;f="hsv"}else e.hasOwnProperty("h")&&(e.hasOwnProperty("s")&&e.hasOwnProperty("l"))&&(e.s=I(e.s),e.l=I(e.l),h=b(e.h,e.s,e.l),d=!0,f="hsl");e.hasOwnProperty("a")&&(k=e.a)}k=P(k);e=e.format||f;f=F(255,A(h.r,0));g=F(255,A(h.g,0));h=F(255,A(h.b,0));this._originalInput=a;this._r=f;this._g=g;this._b=h;this._a=k;this._roundA=t(100*this._a)/100;this._format=c.format||e;this._gradientType=c.gradientType;1>this._r&&(this._r=t(this._r));
1>this._g&&(this._g=t(this._g));1>this._b&&(this._b=t(this._b));this._ok=d;this._tc_id=L++};r.prototype={isDark:function(){return 128>this.getBrightness()},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var a=this.toRgb();return(299*a.r+587*a.g+114*a.b)/1E3},setAlpha:function(a){this._a=P(a);this._roundA=t(100*
this._a)/100;return this},toHsv:function(){var a=c(this._r,this._g,this._b);return{h:360*a.h,s:a.s,v:a.v,a:this._a}},toHsvString:function(){var a=c(this._r,this._g,this._b),b=t(360*a.h),d=t(100*a.s),a=t(100*a.v);return 1==this._a?"hsv("+b+", "+d+"%, "+a+"%)":"hsva("+b+", "+d+"%, "+a+"%, "+this._roundA+")"},toHsl:function(){var b=a(this._r,this._g,this._b);return{h:360*b.h,s:b.s,l:b.l,a:this._a}},toHslString:function(){var b=a(this._r,this._g,this._b),c=t(360*b.h),d=t(100*b.s),b=t(100*b.l);return 1==
this._a?"hsl("+c+", "+d+"%, "+b+"%)":"hsla("+c+", "+d+"%, "+b+"%, "+this._roundA+")"},toHex:function(a){return d(this._r,this._g,this._b,a)},toHexString:function(a){return"#"+this.toHex(a)},toHex8:function(){return e(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:t(this._r),g:t(this._g),b:t(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+t(this._r)+", "+t(this._g)+", "+t(this._b)+")":"rgba("+t(this._r)+", "+t(this._g)+
", "+t(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:t(100*y(this._r,255))+"%",g:t(100*y(this._g,255))+"%",b:t(100*y(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+t(100*y(this._r,255))+"%, "+t(100*y(this._g,255))+"%, "+t(100*y(this._b,255))+"%)":"rgba("+t(100*y(this._r,255))+"%, "+t(100*y(this._g,255))+"%, "+t(100*y(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":1>this._a?!1:J[d(this._r,this._g,
this._b,!0)]||!1},toFilter:function(a){var b="#"+e(this._r,this._g,this._b,this._a),c=b,d=this._gradientType?"GradientType = 1, ":"";a&&(c=r(a).toHex8String());return"progid:DXImageTransform.Microsoft.gradient("+d+"startColorstr="+b+",endColorstr="+c+")"},toString:function(a){var b=!!a;a=a||this._format;var c=!1,d=1>this._a&&0<=this._a;if(!b&&d&&("hex"===a||"hex6"===a||"hex3"===a||"name"===a))return"name"===a&&0===this._a?this.toName():this.toRgbString();"rgb"===a&&(c=this.toRgbString());"prgb"===
a&&(c=this.toPercentageRgbString());if("hex"===a||"hex6"===a)c=this.toHexString();"hex3"===a&&(c=this.toHexString(!0));"hex8"===a&&(c=this.toHex8String());"name"===a&&(c=this.toName());"hsl"===a&&(c=this.toHslString());"hsv"===a&&(c=this.toHsvString());return c||this.toHexString()},_applyModification:function(a,b){var c=a.apply(null,[this].concat([].slice.call(b)));this._r=c._r;this._g=c._g;this._b=c._b;this.setAlpha(c._a);return this},lighten:function(){return this._applyModification(k,arguments)},
brighten:function(){return this._applyModification(l,arguments)},darken:function(){return this._applyModification(m,arguments)},desaturate:function(){return this._applyModification(f,arguments)},saturate:function(){return this._applyModification(g,arguments)},greyscale:function(){return this._applyModification(h,arguments)},spin:function(){return this._applyModification(n,arguments)},_applyCombination:function(a,b){return a.apply(null,[this].concat([].slice.call(b)))},analogous:function(){return this._applyCombination(E,
arguments)},complement:function(){return this._applyCombination(q,arguments)},monochromatic:function(){return this._applyCombination(G,arguments)},splitcomplement:function(){return this._applyCombination(x,arguments)},triad:function(){return this._applyCombination(s,arguments)},tetrad:function(){return this._applyCombination(u,arguments)}};r.fromRatio=function(a,b){if("object"==typeof a){var c={},d;for(d in a)a.hasOwnProperty(d)&&(c[d]="a"===d?a[d]:I(a[d]));a=c}return r(a,b)};r.equals=function(a,
b){return a&&b?r(a).toRgbString()==r(b).toRgbString():!1};r.random=function(){return r.fromRatio({r:aa(),g:aa(),b:aa()})};r.mix=function(a,b,c){c=0===c?0:c||50;a=r(a).toRgb();b=r(b).toRgb();c/=100;var d=2*c-1,e=b.a-a.a,d=((-1==d*e?d:(d+e)/(1+d*e))+1)/2,e=1-d;return r({r:b.r*d+a.r*e,g:b.g*d+a.g*e,b:b.b*d+a.b*e,a:b.a*c+a.a*(1-c)})};r.readability=function(a,b){var c=r(a),d=r(b),e=c.toRgb(),f=d.toRgb(),c=c.getBrightness(),d=d.getBrightness(),e=Math.max(e.r,f.r)-Math.min(e.r,f.r)+Math.max(e.g,f.g)-Math.min(e.g,
f.g)+Math.max(e.b,f.b)-Math.min(e.b,f.b);return{brightness:Math.abs(c-d),color:e}};r.isReadable=function(a,b){var c=r.readability(a,b);return 125<c.brightness&&500<c.color};r.mostReadable=function(a,b){for(var c=null,d=0,e=!1,f=0;f<b.length;f++){var g=r.readability(a,b[f]),h=125<g.brightness&&500<g.color,g=3*(g.brightness/125)+g.color/500;if(h&&!e||h&&e&&g>d||!h&&!e&&g>d)e=h,d=g,c=r(b[f])}return c};var N=r.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",
beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",
darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",
indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",
magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",
paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",
thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},J=r.hexNames=function(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b}(N),D={rgb:RegExp("rgb[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),rgba:RegExp("rgba[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),
hsl:RegExp("hsl[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),hsla:RegExp("hsla[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),hsv:RegExp("hsv[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),
hsva:RegExp("hsva[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};window.tinycolor=r})();c(function(){c.fn.spectrum.load&&c.fn.spectrum.processNativeColorInputs()})});
